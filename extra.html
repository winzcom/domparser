<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta charset="UTF-8"><style id="litespeed-ccss">input{overflow:visible}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body,h1,h2{margin:0}header,nav,section{display:block}a{background-color:transparent;-webkit-text-decoration-skip:objects}img{border-style:none}svg:not(:root){overflow:hidden}input{font-size:100%;line-height:1.15;margin:0}[type=submit]{-webkit-appearance:button}[type=submit]::-moz-focus-inner{border-style:none;padding:0}[type=submit]:-moz-focusring{outline:ButtonText dotted 1px}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{box-sizing:border-box}body{font-size:16px;color:rgba(64,64,64,1)}*,:after,:before{box-sizing:inherit}.ct-section-inner-wrap{margin-left:auto;margin-right:auto;height:100%}div.ct-fancy-icon{display:inline-flex;border-radius:50%}.ct-fancy-icon>svg{fill:currentColor}.oxy-nav-menu-list{display:flex;padding:0;margin:0}.oxy-nav-menu .oxy-nav-menu-list li.menu-item{list-style-type:none;display:flex;flex-direction:column}.oxy-nav-menu .oxy-nav-menu-list li.menu-item a{text-decoration:none;border-style:solid;border-width:0;border-color:transparent}.oxy-nav-menu .menu-item,.oxy-nav-menu .sub-menu{position:relative}.oxy-nav-menu .menu-item .sub-menu{padding:0;flex-direction:column;white-space:nowrap;visibility:hidden;opacity:0;display:flex;position:absolute;top:100%}.oxy-nav-menu .sub-menu li.menu-item{flex-direction:column}.oxy-header-wrapper{position:relative}.oxy-header-row{width:100%;display:block}.oxy-header-container{height:100%;margin-left:auto;margin-right:auto;display:flex;flex-wrap:nowrap;justify-content:flex-start;align-items:stretch}.oxy-header-center,.oxy-header-left,.oxy-header-right{display:flex;align-items:center}.oxy-header-left{justify-content:flex-start}.oxy-header-center{flex-grow:1;justify-content:center}.oxy-header-right{justify-content:flex-end}.oxy-menu-toggle{display:none}.oxy-nav-menu:not(.oxy-nav-menu-open) .sub-menu{background-color:#fff;z-index:2147483641}.oxy-nav-menu-hamburger-wrap{display:flex;align-items:center;justify-content:center}.oxy-nav-menu-hamburger{display:flex;justify-content:space-between;flex-direction:column}.oxy-nav-menu-hamburger-line{border-radius:2px}.oxy-nav-menu .menu-item a{display:flex;align-items:center}.oxy-nav-menu-dropdowns.oxy-nav-menu-dropdown-arrow .menu-item-has-children>a:after{width:.35em;height:.35em;margin-left:.5em;border-right:.1em solid;border-top:.1em solid;transform:rotate(135deg);content:""}.oxy-comment-form input{padding:.5em;border-radius:0;border:1px solid #000;color:gray;width:100%}#code_block-22-18876{flex-direction:unset;display:none}@media (max-width:767px){#code_block-22-18876{flex-direction:unset;display:flex}}#code_block-77-18194{position:fixed;top:200px;display:flex;flex-direction:column;padding-left:10px;font-size:20px}@media (max-width:991px){#code_block-77-18194{flex-direction:unset;display:none}}#link-8-18193{url-encoded:true}#image-16-18193{width:240px;z-index:100}#fancy_icon-9-18193{color:#fff}#_nav_menu-18-18193 .oxy-nav-menu-hamburger-line{background-color:#fff}@media (max-width:991px){#_nav_menu-18-18193 .oxy-nav-menu-list{display:none}#_nav_menu-18-18193 .oxy-menu-toggle{display:initial}}#_nav_menu-18-18193 .oxy-nav-menu-hamburger-wrap{width:42px;height:42px;margin-top:6px;margin-bottom:6px}#_nav_menu-18-18193 .oxy-nav-menu-hamburger{width:30px;height:24px}#_nav_menu-18-18193 .oxy-nav-menu-hamburger-line{height:4px}#_nav_menu-18-18193{min-height:54px;z-index:100}#_nav_menu-18-18193 .oxy-nav-menu-list{flex-direction:row}#_nav_menu-18-18193 .menu-item a{padding-top:12px;padding-left:20px;padding-right:20px;padding-bottom:12px;color:#fff}#_nav_menu-18-18193.oxy-nav-menu:not(.oxy-nav-menu-open) .sub-menu{background-color:#3390be}#_nav_menu-18-18193.oxy-nav-menu:not(.oxy-nav-menu-open) .sub-menu .menu-item a{border:0;padding-top:12px;padding-bottom:12px}#_header_row-2-18193 .oxy-nav-menu:not(.oxy-nav-menu-open) .sub-menu{background-color:#1080b6}#_header_row-2-18193{background-color:#1080b6}#section-7-18731>.ct-section-inner-wrap{max-width:840px;padding-bottom:0;display:block;flex-direction:unset}#section-7-18731{text-align:left}#div_block-17-18731{flex-direction:unset;display:flex;align-items:center;margin-bottom:30px}@media (max-width:767px){#div_block-17-18731{font-size:16px}}#headline-2-18731{margin-bottom:30px}#image-13-18731{width:40px;border-radius:20px;margin-right:15px}#code_block-114-18731{margin-bottom:30px}#_comment_form-39-18731 input{border-color:#ccc;border-radius:3px}.ct-section{width:100%;background-size:cover;background-repeat:repeat}.ct-section>.ct-section-inner-wrap{display:flex;flex-direction:column;align-items:flex-start}.ct-div-block{display:flex;flex-wrap:nowrap;flex-direction:column;align-items:flex-start}.ct-link{display:flex;flex-wrap:wrap;text-align:center;text-decoration:none;flex-direction:column;align-items:center;justify-content:center}.ct-image{max-width:100%}.ct-fancy-icon>svg{width:55px;height:55px}.ct-span{display:inline-block;text-decoration:inherit}@media screen and (-ms-high-contrast:active),(-ms-high-contrast:none){.ct-div-block,.ct-text-block,.ct-headline{max-width:100%}img{flex-shrink:0}body *{min-height:1px}}.ct-section-inner-wrap,.oxy-header-container{max-width:1120px}body{font-family:'Open Sans'}body{line-height:1.8;font-size:17px;font-weight:400;color:#222}.oxy-nav-menu-hamburger-line{background-color:#222}h1,h2{font-family:'Roboto Slab';font-size:48px;font-weight:400;line-height:1.2}h2{font-size:40px;line-height:1.4}a{color:#1080b6;text-decoration:none}.ct-link{text-decoration:}.ct-section-inner-wrap{padding-top:50px;padding-right:20px;padding-bottom:50px;padding-left:20px}.oxy-header-container{padding-right:20px;padding-left:20px}@media (max-width:991px){.hc_s_left:not(.ct-section):not(.oxy-easy-posts){flex-direction:unset}}.hc_search_icon{color:#333}.hc_search_icon>svg{width:16px;height:16px}.hc_search_icon{z-index:100;margin-left:20px}@media (max-width:991px){.hc_search_icon:not(.ct-section):not(.oxy-easy-posts){display:none}}.hc_s_link{display:flex;align-items:center}.hc_s_icon{display:flex;padding:.667em}.hc_s_icon svg{display:inline-block;width:1em;height:1em;fill:#fff;color:#fff}.hc_s_fb{background-color:#3569b4}.hc_s_tw{background-color:#28ace0}.hc_s_li{background-color:#0277b5}.hc_s_xi{background-color:#01615f}@media (max-width:767px){.hc_s_icon svg{width:4em}}@media (max-width:479px){.hc_s_icon svg{width:2em}}.hc_s_left .hc_s_link{margin-bottom:10px}h1,h2{margin:0 0 24px}h2{margin-top:24px}img{max-width:100%;height:auto}@media (max-width:991px){h1{font-size:40px;margin-bottom:10px}h2{font-size:32px}}@media (max-width:767px){h1{font-size:36px}}@media (max-width:767px){.oxy-nav-menu .oxy-nav-menu-list li.menu-item{margin-bottom:2em;font-weight:600}.oxy-nav-menu .sub-menu li.menu-item{margin-bottom:0;font-weight:400}.oxy-nav-menu .sub-menu li.menu-item a{padding-top:8px!important;padding-bottom:8px!important}}.hc_image_100pc img{width:100%}.mo-optin-form-wrapper{margin-bottom:24px!important}input{font-family:'Open Sans'}div#XVhImtjdbW{font-family:'Open Sans',Helvetica,Arial,sans-serif}div#XVhImtjdbW .mo-optin-form-description{text-align:center}div#XVhImtjdbW .mo-optin-form-headline{line-height:1.2!important;margin-bottom:20px!important}div#XVhImtjdbW .mo-optin-fields-wrapper{padding:0 50px}div#XVhImtjdbW .mo-optin-form-name-field{margin-bottom:10px!important}div#XVhImtjdbW .mo-optin-form-note{margin-top:10px!important;font-style:normal!important}div#stIcbznuaN{font-family:'Open Sans',Helvetica,Arial,sans-serif}div#stIcbznuaN .mo-optin-form-description{text-align:center}div#stIcbznuaN .mo-optin-form-headline{line-height:1.2!important;margin-bottom:20px!important}div#stIcbznuaN .mo-optin-fields-wrapper{padding:0 50px}div#stIcbznuaN .mo-optin-form-name-field{margin-bottom:10px!important}div#stIcbznuaN .mo-optin-form-note{margin-top:10px!important;font-style:normal!important}</style><link rel="preload" data-asynced="1" data-optimized="2" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://www.happycoders.eu/wp-content/litespeed/css/0651ac8aab6f9733c6b45f7a4a45ebb9.css?ver=1eed2" /><script src="data:text/javascript;base64,IWZ1bmN0aW9uKGEpeyJ1c2Ugc3RyaWN0Ijt2YXIgYj1mdW5jdGlvbihiLGMsZCl7ZnVuY3Rpb24gZShhKXtyZXR1cm4gaC5ib2R5P2EoKTp2b2lkIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtlKGEpfSl9ZnVuY3Rpb24gZigpe2kuYWRkRXZlbnRMaXN0ZW5lciYmaS5yZW1vdmVFdmVudExpc3RlbmVyKCJsb2FkIixmKSxpLm1lZGlhPWR8fCJhbGwifXZhciBnLGg9YS5kb2N1bWVudCxpPWguY3JlYXRlRWxlbWVudCgibGluayIpO2lmKGMpZz1jO2Vsc2V7dmFyIGo9KGguYm9keXx8aC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpWzBdKS5jaGlsZE5vZGVzO2c9altqLmxlbmd0aC0xXX12YXIgaz1oLnN0eWxlU2hlZXRzO2kucmVsPSJzdHlsZXNoZWV0IixpLmhyZWY9YixpLm1lZGlhPSJvbmx5IHgiLGUoZnVuY3Rpb24oKXtnLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGksYz9nOmcubmV4dFNpYmxpbmcpfSk7dmFyIGw9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPWkuaHJlZixjPWsubGVuZ3RoO2MtLTspaWYoa1tjXS5ocmVmPT09YilyZXR1cm4gYSgpO3NldFRpbWVvdXQoZnVuY3Rpb24oKXtsKGEpfSl9O3JldHVybiBpLmFkZEV2ZW50TGlzdGVuZXImJmkuYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsZiksaS5vbmxvYWRjc3NkZWZpbmVkPWwsbChmKSxpfTsidW5kZWZpbmVkIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0cy5sb2FkQ1NTPWI6YS5sb2FkQ1NTPWJ9KCJ1bmRlZmluZWQiIT10eXBlb2YgZ2xvYmFsP2dsb2JhbDp0aGlzKTshZnVuY3Rpb24oYSl7aWYoYS5sb2FkQ1NTKXt2YXIgYj1sb2FkQ1NTLnJlbHByZWxvYWQ9e307aWYoYi5zdXBwb3J0PWZ1bmN0aW9uKCl7dHJ5e3JldHVybiBhLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImxpbmsiKS5yZWxMaXN0LnN1cHBvcnRzKCJwcmVsb2FkIil9Y2F0Y2goYil7cmV0dXJuITF9fSxiLnBvbHk9ZnVuY3Rpb24oKXtmb3IodmFyIGI9YS5kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgibGluayIpLGM9MDtjPGIubGVuZ3RoO2MrKyl7dmFyIGQ9YltjXTsicHJlbG9hZCI9PT1kLnJlbCYmInN0eWxlIj09PWQuZ2V0QXR0cmlidXRlKCJhcyIpJiYoYS5sb2FkQ1NTKGQuaHJlZixkLGQuZ2V0QXR0cmlidXRlKCJtZWRpYSIpKSxkLnJlbD1udWxsKX19LCFiLnN1cHBvcnQoKSl7Yi5wb2x5KCk7dmFyIGM9YS5zZXRJbnRlcnZhbChiLnBvbHksMzAwKTthLmFkZEV2ZW50TGlzdGVuZXImJmEuYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsZnVuY3Rpb24oKXtiLnBvbHkoKSxhLmNsZWFySW50ZXJ2YWwoYyl9KSxhLmF0dGFjaEV2ZW50JiZhLmF0dGFjaEV2ZW50KCJvbmxvYWQiLGZ1bmN0aW9uKCl7YS5jbGVhckludGVydmFsKGMpfSl9fX0odGhpcyk7" defer></script>
<meta name="viewport" content="width=device-width">


<link rel="alternate" hreflang="x-default" href="https://www.happycoders.eu/algorithms/red-black-tree-java/" />
<link rel="alternate" hreflang="en" href="https://www.happycoders.eu/algorithms/red-black-tree-java/" />
<link rel="alternate" hreflang="de" href="https://www.happycoders.eu/de/algorithmen/rot-schwarz-baum-java/" />
<link rel="alternate" hreflang="x-default" href="https://www.happycoders.eu/algorithms/red-black-tree-java/" />
<title>Red-Black Tree (Fully Explained, with Java Code)</title>
<meta name="dc.title" content="Red-Black Tree (Fully Explained, with Java Code)" />
<meta name="dc.description" content="What is a red-black tree? By which rules is it balanced? How do you determine its time complexity? And how do you implement it in Java?" />
<meta name="dc.relation" content="https://www.happycoders.eu/algorithms/red-black-tree-java/" />
<meta name="dc.source" content="https://www.happycoders.eu/" />
<meta name="dc.language" content="en_US" />
<meta name="description" content="What is a red-black tree? By which rules is it balanced? How do you determine its time complexity? And how do you implement it in Java?" />
<meta name="thumbnail" content="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java.jpg" />
<meta name="robots" content="index, follow" />
<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
<link rel="canonical" href="https://www.happycoders.eu/algorithms/red-black-tree-java/" />
<meta property="og:url" content="https://www.happycoders.eu/algorithms/red-black-tree-java/" />
<meta property="og:site_name" content="HappyCoders.eu" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Red-Black Tree (Fully Explained, with Java Code)" />
<meta property="og:description" content="What is a red-black tree? By which rules is it balanced? How do you determine its time complexity? And how do you implement it in Java?" />
<meta property="og:image" content="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java.jpg" />
<meta property="og:image:secure_url" content="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java.jpg" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="675" />
<meta property="og:image:alt" content="Red-blak tree with Java code" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="svenwoltmann" />
<meta name="twitter:creator" content="@svenwoltmann" />
<meta name="twitter:title" content="Red-Black Tree (Fully Explained, with Java Code)" />
<meta name="twitter:description" content="What is a red-black tree? By which rules is it balanced? How do you determine its time complexity? And how do you implement it in Java?" />
<meta name="twitter:image" content="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java.jpg" />
<link href='https://fonts.gstatic.com' crossorigin rel='preconnect' />
<script type="application/ld+json">{"@context":"https:\/\/schema.org\/","@type":"TechArticle","datePublished":"2021-09-29T17:46:22+02:00","dateModified":"2022-01-19T16:17:21+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.happycoders.eu\/algorithms\/red-black-tree-java"},"headline":"Red-Black Tree (Fully Explained, with Java Code)","author":{"@type":"Person","name":"Sven Woltmann","url":"https:\/\/www.happycoders.eu\/author\/sven\/"},"image":{"@type":"ImageObject","url":"https:\/\/www.happycoders.eu\/wp-content\/uploads\/2021\/09\/red-black-tree-java.jpg"},"publisher":{"@type":"Organization","name":"HappyCoders.eu","logo":{"@type":"ImageObject","url":"https:\/\/www.happycoders.eu\/wp-content\/uploads\/2021\/01\/happycoders_logo_blue_white_445x60.png","width":"445","height":"60"}},"description":"What is a red-black tree? How do you insert, search and delete nodes? By which rules is the tree balanced? How to implement a red-black tree in Java? And how&hellip;"}</script>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/www.happycoders.eu"},{"@type":"ListItem","position":2,"name":"Algorithms and Data Structures","item":"https:\/\/www.happycoders.eu\/algorithms\/"},{"@type":"ListItem","position":3,"name":"Red-Black Tree (Fully Explained, with Java Code)","item":"https:\/\/www.happycoders.eu\/algorithms\/red-black-tree-java\/"}]}</script>
<link rel="alternate" type="application/rss+xml" title="HappyCoders.eu &raquo; Red-Black Tree (Fully Explained, with Java Code) Comments Feed" href="https://www.happycoders.eu/algorithms/red-black-tree-java/feed/" />

<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>

<script   type='text/javascript' src='https://www.happycoders.eu/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js' defer data-deferred="1"></script>


<script src="data:text/javascript;base64,Y29uc3QgY3lyYjUzPWZ1bmN0aW9uKHN0cixzZWVkPTApe2xldCBoMT0weGRlYWRiZWVmXnNlZWQsaDI9MHg0MWM2Y2U1N15zZWVkO2ZvcihsZXQgaT0wLGNoO2k8c3RyLmxlbmd0aDtpKyspe2NoPXN0ci5jaGFyQ29kZUF0KGkpO2gxPU1hdGguaW11bChoMV5jaCwyNjU0NDM1NzYxKTtoMj1NYXRoLmltdWwoaDJeY2gsMTU5NzMzNDY3Nyl9CmgxPU1hdGguaW11bChoMV5oMT4+PjE2LDIyNDY4MjI1MDcpXk1hdGguaW11bChoMl5oMj4+PjEzLDMyNjY0ODk5MDkpO2gyPU1hdGguaW11bChoMl5oMj4+PjE2LDIyNDY4MjI1MDcpXk1hdGguaW11bChoMV5oMT4+PjEzLDMyNjY0ODk5MDkpO3JldHVybiA0Mjk0OTY3Mjk2KigyMDk3MTUxJmgyKSsoaDE+Pj4wKX07bGV0IGNsaWVudElQPSIxODUuMTU5LjE2Mi4yNCI7bGV0IHZhbGlkaXR5SW50ZXJ2YWw9TWF0aC5yb3VuZChuZXcgRGF0ZSgpLzEwMDAvMzYwMC8yNC8zMCk7bGV0IGNsaWVudElEU291cmNlPWNsaWVudElQKyI7Iit3aW5kb3cubG9jYXRpb24uaG9zdCsiOyIrbmF2aWdhdG9yLnVzZXJBZ2VudCsiOyIrbmF2aWdhdG9yLmxhbmd1YWdlKyI7Iit2YWxpZGl0eUludGVydmFsO2xldCBjbGllbnRJREhhc2hlZD1jeXJiNTMoY2xpZW50SURTb3VyY2UpLnRvU3RyaW5nKDE2KTsoZnVuY3Rpb24oaSxzLG8sZyxyLGEsbSl7aS5Hb29nbGVBbmFseXRpY3NPYmplY3Q9cjtpW3JdPWlbcl18fGZ1bmN0aW9uKCl7KGlbcl0ucT1pW3JdLnF8fFtdKS5wdXNoKGFyZ3VtZW50cyl9LGlbcl0ubD0xKm5ldyBEYXRlKCk7YT1zLmNyZWF0ZUVsZW1lbnQobyksbT1zLmdldEVsZW1lbnRzQnlUYWdOYW1lKG8pWzBdO2EuYXN5bmM9MTthLnNyYz1nO20ucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYSxtKX0pKHdpbmRvdyxkb2N1bWVudCwnc2NyaXB0JywnLy93d3cuZ29vZ2xlLWFuYWx5dGljcy5jb20vYW5hbHl0aWNzLmpzJywnZ2EnKTtnYSgnY3JlYXRlJywnVUEtMTIyNjc1MDIxLTEnLHsnc3RvcmFnZSc6J25vbmUnLCdjbGllbnRJZCc6Y2xpZW50SURIYXNoZWR9KTtnYSgnc2V0JywnYW5vbnltaXplSXAnLCEwKTtnYSgnc2VuZCcsJ3BhZ2V2aWV3Jyk=" defer></script>
<meta name="theme-color" content="#1080B6" /><style>.breadcrumb {list-style: none;margin:0}.breadcrumb li {margin:0;display:inline;position:relative}.breadcrumb li::after{content:'  »  '}.breadcrumb li:last-child::after{display:none}</style><style id="uagb-style-conditional-extension">@media (min-width: 1025px){body .uag-hide-desktop.uagb-google-map__wrap,body .uag-hide-desktop{display:none}}@media (min-width: 768px) and (max-width: 1024px){body .uag-hide-tab.uagb-google-map__wrap,body .uag-hide-tab{display:none}}@media (max-width: 767px){body .uag-hide-mob.uagb-google-map__wrap,body .uag-hide-mob{display:none}}</style><link rel="icon" href="https://www.happycoders.eu/wp-content/uploads/2018/09/cropped-happycoders_favicon_512-224x224.png" sizes="32x32" />
<link rel="icon" href="https://www.happycoders.eu/wp-content/uploads/2018/09/cropped-happycoders_favicon_512-224x224.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://www.happycoders.eu/wp-content/uploads/2018/09/cropped-happycoders_favicon_512-224x224.png" />
<meta name="msapplication-TileImage" content="https://www.happycoders.eu/wp-content/uploads/2018/09/cropped-happycoders_favicon_512-336x336.png" />
<link rel='preload' as="style" onload="this.onload=null;this.rel='stylesheet'" data-wpacu-preload-it-async='1' id='wpacu-combined-google-fonts-css-async-preload' href='https://fonts.googleapis.com/css?family=Open+Sans:600,italic,regular|Roboto+Slab:700,regular&amp;display=swap' type='text/css' media='all' />
<script id="wpacu-preload-async-css-fallback" src="data:text/javascript;base64,LyohIExvYWRDU1MuIFtjXTIwMjAgRmlsYW1lbnQgR3JvdXAsIEluYy4gTUlUIExpY2Vuc2UgKi8KKGZ1bmN0aW9uKHcpeyJ1c2Ugc3RyaWN0Ijt2YXIgd3BhY3VMb2FkQ1NTPWZ1bmN0aW9uKGhyZWYsYmVmb3JlLG1lZGlhLGF0dHJpYnV0ZXMpe3ZhciBkb2M9dy5kb2N1bWVudDt2YXIgc3M9ZG9jLmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTt2YXIgcmVmO2lmKGJlZm9yZSl7cmVmPWJlZm9yZX1lbHNle3ZhciByZWZzPShkb2MuYm9keXx8ZG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0pLmNoaWxkTm9kZXM7cmVmPXJlZnNbcmVmcy5sZW5ndGgtMV19CnZhciBzaGVldHM9ZG9jLnN0eWxlU2hlZXRzO2lmKGF0dHJpYnV0ZXMpe2Zvcih2YXIgYXR0cmlidXRlTmFtZSBpbiBhdHRyaWJ1dGVzKXtpZihhdHRyaWJ1dGVzLmhhc093blByb3BlcnR5KGF0dHJpYnV0ZU5hbWUpKXtzcy5zZXRBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSxhdHRyaWJ1dGVzW2F0dHJpYnV0ZU5hbWVdKX19fQpzcy5yZWw9InN0eWxlc2hlZXQiO3NzLmhyZWY9aHJlZjtzcy5tZWRpYT0ib25seSB4IjtmdW5jdGlvbiByZWFkeShjYil7aWYoZG9jLmJvZHkpe3JldHVybiBjYigpfQpzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cmVhZHkoY2IpfSl9CnJlYWR5KGZ1bmN0aW9uKCl7cmVmLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHNzLChiZWZvcmU/cmVmOnJlZi5uZXh0U2libGluZykpfSk7dmFyIG9ud3BhY3Vsb2FkY3NzZGVmaW5lZD1mdW5jdGlvbihjYil7dmFyIHJlc29sdmVkSHJlZj1zcy5ocmVmO3ZhciBpPXNoZWV0cy5sZW5ndGg7d2hpbGUoaS0tKXtpZihzaGVldHNbaV0uaHJlZj09PXJlc29sdmVkSHJlZil7cmV0dXJuIGNiKCl9fQpzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7b253cGFjdWxvYWRjc3NkZWZpbmVkKGNiKX0pfTtmdW5jdGlvbiBsb2FkQ0IoKXtpZihzcy5hZGRFdmVudExpc3RlbmVyKXtzcy5yZW1vdmVFdmVudExpc3RlbmVyKCJsb2FkIixsb2FkQ0IpfQpzcy5tZWRpYT1tZWRpYXx8ImFsbCJ9CmlmKHNzLmFkZEV2ZW50TGlzdGVuZXIpe3NzLmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLGxvYWRDQil9CnNzLm9ud3BhY3Vsb2FkY3NzZGVmaW5lZD1vbndwYWN1bG9hZGNzc2RlZmluZWQ7b253cGFjdWxvYWRjc3NkZWZpbmVkKGxvYWRDQik7cmV0dXJuIHNzfTtpZih0eXBlb2YgZXhwb3J0cyE9PSJ1bmRlZmluZWQiKXtleHBvcnRzLndwYWN1TG9hZENTUz13cGFjdUxvYWRDU1N9ZWxzZXt3LndwYWN1TG9hZENTUz13cGFjdUxvYWRDU1N9fSh0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCI/Z2xvYmFsOnRoaXMpKQ==" defer></script>









</head>
<body class="post-template-default single single-post postid-22731 single-format-standard  wp-embed-responsive oxygen-body" >



						<header id="_header-1-18193" class="oxy-header-wrapper oxy-overlay-header oxy-header"><div id="_header_row-2-18193" class="oxy-header-row"><div class="oxy-header-container"><div id="_header_left-3-18193" class="oxy-header-left"><a id="link-8-18193" class="ct-link" href="/"><img id="image-16-18193" alt="HappyCoders logo" src="https://www.happycoders.eu/wp-content/uploads/2018/07/happycoders_white.svg" class="ct-image" srcset="" sizes="(max-width: 296px) 100vw, 296px"></a></div><div id="_header_center-4-18193" class="oxy-header-center"></div><div id="_header_right-5-18193" class="oxy-header-right"><nav id="_nav_menu-18-18193" class="oxy-nav-menu oxy-nav-menu-dropdowns oxy-nav-menu-dropdown-arrow oxy-nav-menu-responsive-dropdowns"><div class="oxy-menu-toggle"><div class="oxy-nav-menu-hamburger-wrap"><div class="oxy-nav-menu-hamburger"><div class="oxy-nav-menu-hamburger-line"></div><div class="oxy-nav-menu-hamburger-line"></div><div class="oxy-nav-menu-hamburger-line"></div></div></div></div><div class="menu-hauptmenu-englisch-container"><ul id="menu-hauptmenu-englisch" class="oxy-nav-menu-list"><li id="menu-item-4831" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-has-children menu-item-4831"><a href="https://www.happycoders.eu/blog/">Blog</a>
<ul class="sub-menu">
	<li id="menu-item-6666" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6666"><a href="https://www.happycoders.eu/java/">Java</a></li>
	<li id="menu-item-13463" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-13463"><a href="https://www.happycoders.eu/algorithms/">Algorithms and Data Structures</a></li>
	<li id="menu-item-6665" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6665"><a href="https://www.happycoders.eu/devops/">DevOps</a></li>
	<li id="menu-item-6667" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6667"><a href="https://www.happycoders.eu/books/">Books</a></li>
</ul>
</li>
<li id="menu-item-8722" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8722"><a href="https://www.happycoders.eu/about-sven-woltmann/">About</a></li>
<li id="menu-item-13188" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-13188"><a href="https://www.happycoders.eu/newsletter/">Newsletter</a></li>
<li id="menu-item-wpml-ls-13-en" class="menu-item wpml-ls-slot-13 wpml-ls-item wpml-ls-item-en wpml-ls-current-language wpml-ls-menu-item wpml-ls-first-item menu-item-type-wpml_ls_menu_item menu-item-object-wpml_ls_menu_item menu-item-has-children menu-item-wpml-ls-13-en"><a title="English" href="https://www.happycoders.eu/algorithms/red-black-tree-java/"><span class="wpml-ls-native" lang="en">English</span></a>
<ul class="sub-menu">
	<li id="menu-item-wpml-ls-13-de" class="menu-item wpml-ls-slot-13 wpml-ls-item wpml-ls-item-de wpml-ls-menu-item wpml-ls-last-item menu-item-type-wpml_ls_menu_item menu-item-object-wpml_ls_menu_item menu-item-wpml-ls-13-de"><a title="Deutsch" href="https://www.happycoders.eu/de/algorithmen/rot-schwarz-baum-java/"><span class="wpml-ls-native" lang="de">Deutsch</span></a></li>
</ul>
</li>
</ul></div></nav><div id="fancy_icon-9-18193" class="ct-fancy-icon hc_search_icon"><svg id="svg-fancy_icon-9-18193"><use xlink:href="#FontAwesomeicon-search"></use></svg></div></div></div></div></header>
		<div id="code_block-77-18194" class="ct-code-block hc_s_left"><a class="hc_s_link hc_s_fb" href="javascript:void(0)" onclick="openSharerFB(); return false;">
  <span class="hc_s_icon">
    <svg viewbox="0 0 264 512">
      <path d="M76.7 512V283H0v-91h76.7v-71.7C76.7 42.4 124.3 0 193.8 0c33.3 0 61.9 2.5 70.2 3.6V85h-48.2c-37.8 0-45.1 18-45.1 44.3V192H256l-11.7 91h-73.6v229"></path>
    </svg>
  </span>
</a>

<a class="hc_s_link hc_s_tw" href="javascript:void(0)" onclick="openSharerTW(); return false;">
  <span class="hc_s_icon">
    <svg viewbox="0 0 512 512">
      <path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path>
    </svg>
  </span>
</a>

<a class="hc_s_link hc_s_li" href="javascript:void(0)" onclick="openSharerLI(); return false;">
  <span class="hc_s_icon">
    <svg viewbox="0 0 448 512">
      <path d="M100.3 480H7.4V180.9h92.9V480zM53.8 140.1C24.1 140.1 0 115.5 0 85.8 0 56.1 24.1 32 53.8 32c29.7 0 53.8 24.1 53.8 53.8 0 29.7-24.1 54.3-53.8 54.3zM448 480h-92.7V334.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V480h-92.8V180.9h89.1v40.8h1.3c12.4-23.5 42.7-48.3 87.9-48.3 94 0 111.3 61.9 111.3 142.3V480z"></path>
    </svg>
  </span>
</a>


<a class="hc_s_link hc_s_xi" href="javascript:void(0)" onclick="openSharerXI(); return false;">
  <span class="hc_s_icon">
    <svg viewbox="0 0 384 512">
      <path d="M162.7 210c-1.8 3.3-25.2 44.4-70.1 123.5-4.9 8.3-10.8 12.5-17.7 12.5H9.8c-7.7 0-12.1-7.5-8.5-14.4l69-121.3c.2 0 .2-.1 0-.3l-43.9-75.6c-4.3-7.8.3-14.1 8.5-14.1H100c7.3 0 13.3 4.1 18 12.2l44.7 77.5zM382.6 46.1l-144 253v.3L330.2 466c3.9 7.1.2 14.1-8.5 14.1h-65.2c-7.6 0-13.6-4-18-12.2l-92.4-168.5c3.3-5.8 51.5-90.8 144.8-255.2 4.6-8.1 10.4-12.2 17.5-12.2h65.7c8 0 12.3 6.7 8.5 14.1z"></path>
    </svg>
  </span>
</a>
</div><section id="section-7-18731" class=" ct-section "><div class="ct-section-inner-wrap"><div id="code_block-114-18731" class="ct-code-block"><img src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java-800x450.jpg" srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java-800x450.jpg 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java-224x126.jpg 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java-336x189.jpg 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java-504x284.jpg 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java-672x378.jpg 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java-400x225.jpg 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java-600x338.jpg 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java-944x531.jpg 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java.jpg 1200w" sizes="(max-width: 800px) 100vw, 800px" width="800" height="450" class="wmu-preview-img" alt="Red-blak tree with Java code"></div><h1 id="headline-2-18731" class="ct-headline"><span id="Red-Black_Tree_Fully_Explained_with_Java_Code"><span id="span-3-18731" class="ct-span">Red-Black Tree (Fully Explained, with Java Code)</span></span></h1><div id="div_block-17-18731" class="ct-div-block"><img data-lazyloaded="1" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" id="image-13-18731" alt="Author image" data-src="https://www.happycoders.eu/wp-content/litespeed/avatar/2d3d80eb5423c827943d33ca18c72b94.jpg" class="ct-image"><div id="text_block-5-18731" class="ct-text-block">by <span id="span-6-18731" class="ct-span">Sven Woltmann</span> – <span id="span-24-18731" class="ct-span">September 29, 2021</span></div></div></div></section><section id="section-7-18194" class=" ct-section "><div class="ct-section-inner-wrap"><div id="text_block-14-18194" class="ct-text-block"><span id="span-15-18194" class="ct-span oxy-stock-content-styles">
<div class="wp-container-62045446dd6a1 wp-block-group hc-series-box"><div class="wp-block-group__inner-container">
<p class="hc-series-box-h1"><strong>Article Series:</strong> Trees</p>



<p><a href="/algorithms/binary-tree-java/">Part 1: Binary Tree</a></p>



<p><a href="/algorithms/binary-search-tree-java/">Part 2: Binary Search Tree</a></p>



<p><a href="/algorithms/avl-tree-java/">Part 3: AVL Tree</a></p>



<p><strong>Part 4: Red-Black Tree</strong></p>



<p class="hc-series-nl">(Sign up for the <a href="#" data-formkit-toggle="7802e02f97">HappyCoders Newsletter</a><br>to be immediately informed about new parts.)</p>
</div></div>



<p>The red-black tree is a widely used concrete implementation of a <a href="/algorithms/binary-search-tree-java/#Self-Balancing_Binary_Search_Tree">self-balancing binary search tree</a>.&nbsp;In the JDK, it is used in <a rel="noopener" href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/TreeMap.html" target="_blank">TreeMap</a>, and since Java 8, it is also used for bucket collisions in <a rel="noopener" href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/HashMap.html" target="_blank">HashMap</a>. How does it work?</p>



<p>In this article, you will learn:</p>



<ul><li>What is a red-black tree?</li><li>How do you insert elements into a red-black tree? How do you remove them?</li><li>What are the rules for balancing a red-black tree?</li><li>How to implement a red-black tree in Java?</li><li>How to determine its time complexity?</li><li>What distinguishes a red-black tree from other data structures?</li></ul>



<p>You can find the source code for the article in this&nbsp;<a rel="noopener" href="https://github.com/SvenWoltmann/binary-tree" target="_blank">GitHub repository</a>.</p>



<div class="lwptoc lwptoc-autoWidth lwptoc-light lwptoc-notInherit" data-smooth-scroll="1" data-smooth-scroll-offset="24"><div class="lwptoc_i">    <div class="lwptoc_header">
        <b class="lwptoc_title" style="font-weight:600;">Contents</b>                    <span class="lwptoc_toggle">
                <a href="#" class="lwptoc_toggle_label" data-label="show">hide</a>
            </span>
            </div>
<div class="lwptoc_items lwptoc_items-visible" style="font-size:95%;">
    <div class="lwptoc_itemWrap"><div class="lwptoc_item">    <a href="#What_Is_a_Red-Black_Tree">
                    <span class="lwptoc_item_number">1</span>
                <span class="lwptoc_item_label">What Is a Red-Black Tree?</span>
    </a>
    <div class="lwptoc_itemWrap"><div class="lwptoc_item">    <a href="#NIL_Nodes_in_Red-Black_Trees">
                    <span class="lwptoc_item_number">1.1</span>
                <span class="lwptoc_item_label">NIL Nodes in Red-Black Trees</span>
    </a>
    </div><div class="lwptoc_item">    <a href="#Red-Black_Tree_Example">
                    <span class="lwptoc_item_number">1.2</span>
                <span class="lwptoc_item_label">Red-Black Tree Example</span>
    </a>
    </div><div class="lwptoc_item">    <a href="#Red-Black_Tree_Properties">
                    <span class="lwptoc_item_number">1.3</span>
                <span class="lwptoc_item_label">Red-Black Tree Properties</span>
    </a>
    </div><div class="lwptoc_item">    <a href="#Height_of_a_Red-Black_Tree">
                    <span class="lwptoc_item_number">1.4</span>
                <span class="lwptoc_item_label">Height of a Red-Black Tree</span>
    </a>
    </div><div class="lwptoc_item">    <a href="#Black_Height_of_a_Red-Black_Tree">
                    <span class="lwptoc_item_number">1.5</span>
                <span class="lwptoc_item_label">Black Height of a Red-Black Tree</span>
    </a>
    </div></div></div><div class="lwptoc_item">    <a href="#Red-Black_Tree_Java_Implementation">
                    <span class="lwptoc_item_number">2</span>
                <span class="lwptoc_item_label">Red-Black Tree Java Implementation</span>
    </a>
    </div><div class="lwptoc_item">    <a href="#Red_Black_Tree_Rotation">
                    <span class="lwptoc_item_number">3</span>
                <span class="lwptoc_item_label">Red Black Tree Rotation</span>
    </a>
    <div class="lwptoc_itemWrap"><div class="lwptoc_item">    <a href="#Right_Rotation">
                    <span class="lwptoc_item_number">3.1</span>
                <span class="lwptoc_item_label">Right Rotation</span>
    </a>
    </div><div class="lwptoc_item">    <a href="#Left_Rotation">
                    <span class="lwptoc_item_number">3.2</span>
                <span class="lwptoc_item_label">Left Rotation</span>
    </a>
    </div></div></div><div class="lwptoc_item">    <a href="#Red-Black_Tree_Operations">
                    <span class="lwptoc_item_number">4</span>
                <span class="lwptoc_item_label">Red-Black Tree Operations</span>
    </a>
    <div class="lwptoc_itemWrap"><div class="lwptoc_item">    <a href="#Red-Black_Tree_Search">
                    <span class="lwptoc_item_number">4.1</span>
                <span class="lwptoc_item_label">Red-Black Tree Search</span>
    </a>
    </div><div class="lwptoc_item">    <a href="#Red-Black_Tree_Insertion">
                    <span class="lwptoc_item_number">4.2</span>
                <span class="lwptoc_item_label">Red-Black Tree Insertion</span>
    </a>
    </div><div class="lwptoc_item">    <a href="#Red-Black_Tree_Deletion">
                    <span class="lwptoc_item_number">4.3</span>
                <span class="lwptoc_item_label">Red-Black Tree Deletion</span>
    </a>
    </div><div class="lwptoc_item">    <a href="#Traversing_the_Red-Black_Tree">
                    <span class="lwptoc_item_number">4.4</span>
                <span class="lwptoc_item_label">Traversing the Red-Black Tree</span>
    </a>
    </div></div></div><div class="lwptoc_item">    <a href="#Red-Black_Tree_Time_Complexity">
                    <span class="lwptoc_item_number">5</span>
                <span class="lwptoc_item_label">Red-Black Tree Time Complexity</span>
    </a>
    <div class="lwptoc_itemWrap"><div class="lwptoc_item">    <a href="#Search_Time">
                    <span class="lwptoc_item_number">5.1</span>
                <span class="lwptoc_item_label">Search Time</span>
    </a>
    </div><div class="lwptoc_item">    <a href="#Insertion_Time">
                    <span class="lwptoc_item_number">5.2</span>
                <span class="lwptoc_item_label">Insertion Time</span>
    </a>
    </div><div class="lwptoc_item">    <a href="#Deletion_Time">
                    <span class="lwptoc_item_number">5.3</span>
                <span class="lwptoc_item_label">Deletion Time</span>
    </a>
    </div></div></div><div class="lwptoc_item">    <a href="#Red-Black_Tree_Compared_With_Other_Data_Structures">
                    <span class="lwptoc_item_number">6</span>
                <span class="lwptoc_item_label">Red-Black Tree Compared With Other Data Structures</span>
    </a>
    <div class="lwptoc_itemWrap"><div class="lwptoc_item">    <a href="#Red-Black_Tree_vs_AVL_Tree">
                    <span class="lwptoc_item_number">6.1</span>
                <span class="lwptoc_item_label">Red-Black Tree vs. AVL Tree</span>
    </a>
    </div><div class="lwptoc_item">    <a href="#Red-Black_Tree_vs_Binary_Search_Tree">
                    <span class="lwptoc_item_number">6.2</span>
                <span class="lwptoc_item_label">Red-Black Tree vs. Binary Search Tree</span>
    </a>
    </div></div></div><div class="lwptoc_item">    <a href="#Summary">
                    <span class="lwptoc_item_number">7</span>
                <span class="lwptoc_item_label">Summary</span>
    </a>
    </div></div></div>
</div></div><h2><span id="What_Is_a_Red-Black_Tree"><span id="What_Is_a_Red-Black_Tree">What Is a Red-Black Tree?</span></span></h2>



<p>A red-black tree is a self-balancing binary search tree, that is, a binary search tree that automatically maintains some balance.</p>



<p>Each node is assigned a color (red or black). A set of rules specifies how these colors must be arranged (e.g., a red node may not have red children). This arrangement ensures that the tree maintains a certain balance.</p>



<p>After inserting and deleting nodes, quite complex algorithms are applied to check compliance with the rules – and, in case of deviations, to restore the prescribed properties by recoloring nodes and rotations.</p>



<h3><span id="NIL_Nodes_in_Red-Black_Trees"><span id="NIL_Nodes_in_Red-Black_Trees">NIL Nodes in Red-Black Trees</span></span></h3>



<p>In the literature, red-black trees are depicted with and without so-called NIL nodes. A NIL node is a leaf that does not contain a value. NIL nodes become relevant for the algorithms later on, e.g., to determine colors of uncle or sibling nodes.</p>



<p>In Java, NIL nodes can be represented simply by <code>null</code> references; more on this later.</p>



<h3><span id="Red-Black_Tree_Example"><span id="Red-Black_Tree_Example">Red-Black Tree Example</span></span></h3>



<p>The following example shows two possible representations of a red-black tree. The first image shows the tree without (i.e., with implicit) NIL leaves; the second image shows the tree with explicit NIL leaves.</p>



<div class="wp-block-columns hc-no-margin-columns">
<div class="wp-block-column">
<div class="wp-block-image"><figure class="aligncenter size-half_400"><img data-lazyloaded="1" data-placeholder-resp="400x229" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22400%22%20height%3D%22229%22%20viewBox%3D%220%200%20400%20229%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23e9e4e6%22%20d%3D%22M0%200h400v228H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23f077a0%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-74.63515%20-1.30276%20.71437%20-40.92614%20346.1%20215.4)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-139.6114%2014.1466%20-5.85299%20-57.7626%2089.2%20227.3)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(38.7%20144.2%20505.3)%20scale(396.83902%2051.65152)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-28.2%2045.1%20-85.4)%20scale(112.94809%2033.62991)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="400" height="229" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-example-400x229.png" alt="Red-black tree example with implicit NIL leaves" class="wp-image-22370" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-example-400x229.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-example-224x128.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-example-336x192.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-example-504x289.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-example-672x385.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-example-600x344.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-example.png 800w" data-sizes="(max-width: 400px) 100vw, 400px"><figcaption>Red-black tree with implicit NIL leaves</figcaption></figure></div>
</div>



<div class="wp-block-column">
<div class="wp-block-image"><figure class="aligncenter size-half_400"><img data-lazyloaded="1" data-placeholder-resp="400x274" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22400%22%20height%3D%22274%22%20viewBox%3D%220%200%20400%20274%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23e3e2e3%22%20d%3D%22M0%200h400v273H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23a99ea1%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-49.459%2054.1314%20-88.80526%20-81.13995%20362.2%20272.7)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-123.51593%2021.11296%20-9.41328%20-55.06996%2086.5%20272.7)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-32.99533%2044.82259%20-320.87325%20-236.20499%20324.6%20.8)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(13.70844%2028.7816%20-114.42395%2054.49918%2011.6%2031.8)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="400" height="274" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-example-with-nil-400x274.png" alt="Red-black tree example with explicit NIL leaves" class="wp-image-22371" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-example-with-nil-400x274.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-example-with-nil-224x153.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-example-with-nil-336x230.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-example-with-nil-504x345.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-example-with-nil-672x460.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-example-with-nil-600x411.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-example-with-nil.png 800w" data-sizes="(max-width: 400px) 100vw, 400px"><figcaption>Red-black tree with explicit NIL leaves</figcaption></figure></div>
</div>
</div>



<p>In the course of this tutorial, I will generally refrain from showing the NIL leaves. When explaining the insert and delete operations, I will show them sporadically if it facilitates understanding the respective algorithm.</p>



<h3><span id="Red-Black_Tree_Properties"><span id="Red-Black_Tree_Properties">Red-Black Tree Properties</span></span></h3>



<p>The following rules enforce the red-black tree balance:</p>



<ol><li>Each node is either red or black.</li><li>(The root is black.)</li><li>All NIL leaves are black.</li><li>A red node must not have red children.</li><li>All paths from a node to the leaves below contain the same number of black nodes.</li></ol>



<p>Rule 2 is in parentheses because it does not affect the tree's balance. If a child of a red root is also red, the root must be colored black according to rule 4. However, if a red root has only black children, there is no advantage in coloring the root black.</p>



<p>Therefore, rule 2 is often omitted in the literature.</p>



<p>When explaining the insert and delete operations and in the Java code, I will point out where there would be differences if we would also implement rule 2. So much in advance: The difference is only one line of code per operation :)</p>



<p>By the way, from rules 4 and 5 follows that a red node always has either two NIL leaves or two black child nodes with values. If it had one NIL leaf and one black child with value, then the paths through this child would have at least one more black node than the path to the NIL leaf, which would violate rule 5.</p>



<h3><span id="Height_of_a_Red-Black_Tree"><span id="Height_of_a_Red-Black_Tree">Height of a Red-Black Tree</span></span></h3>



<p>We refer to the height of the red-black tree as the maximum number of nodes from the root to a NIL leaf, not including the root. The height of the red-black tree in the example above is 4:</p>



<div class="wp-block-image"><figure class="aligncenter size-half_600"><img data-lazyloaded="1" data-placeholder-resp="600x274" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22600%22%20height%3D%22274%22%20viewBox%3D%220%200%20600%20274%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23ededed%22%20d%3D%22M0%200h600v271H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22translate(1.2%201.2)%20scale(2.34375)%22%20fill-opacity%3D%22.5%22%3E%3Cellipse%20fill%3D%22%23d3d3d3%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(21.9842%20-44.48167%2080.8647%2039.96583%20139.4%2058)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-111.9175%20-229.12764%2032.89317%20-16.06668%20240.2%2043.7)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20cx%3D%2216%22%20cy%3D%2255%22%20rx%3D%2225%22%20ry%3D%22231%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20cx%3D%2261%22%20cy%3D%22107%22%20rx%3D%2266%22%20ry%3D%2220%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="600" height="274" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-height-600x274.png" alt="Height of red-black tree" class="wp-image-22379" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-height-600x274.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-height-224x102.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-height-336x153.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-height-504x230.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-height-672x307.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-height-400x183.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-height-800x365.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-height-944x431.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-height.png 1200w" data-sizes="(max-width: 600px) 100vw, 600px"><figcaption>Height of red-black tree</figcaption></figure></div>



<p>From rules 3 and 4 follows:</p>



<p>The <em>longest</em> path from the root to a leaf (not counting the root) is at most twice as long as the <em>shortest</em> path from the root to a leaf.</p>



<p>That is easily explained:</p>



<p>Let's assume that the shortest path has (in addition to the root) <em>n</em> black nodes and no red nodes. Then we could add another <em>n</em> red nodes before each black node without breaking rule 3 (which we could reword to: no two red nodes may follow each other).</p>



<p>The following example shows the shortest possible path through a red-black tree of height four on the left and the longest possible path on the right:</p>



<div class="wp-block-image"><figure class="aligncenter size-half_600"><img data-lazyloaded="1" data-placeholder-resp="600x274" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22600%22%20height%3D%22274%22%20viewBox%3D%220%200%20600%20274%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23f1f1f1%22%20d%3D%22M0%200h600v271H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23d2d2d2%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(161.9823%20128.84654%20-60.94489%2076.61822%20353.8%20126.5)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(226.931%2059.53423%20-21.36094%2081.42306%20122.5%20205.6)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(72.26638%20527.55741%20-96.57069%2013.22854%20580.4%2039.4)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-81.5721%20-553.00216%2078.05152%20-11.5132%2052%20208.7)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="600" height="274" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-shortest-longest-paths-600x274.png" alt="Shortest and longest path in a red-black tree" class="wp-image-22392" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-shortest-longest-paths-600x274.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-shortest-longest-paths-224x102.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-shortest-longest-paths-336x153.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-shortest-longest-paths-504x230.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-shortest-longest-paths-672x307.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-shortest-longest-paths-400x183.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-shortest-longest-paths-800x365.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-shortest-longest-paths-944x431.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-shortest-longest-paths.png 1200w" data-sizes="(max-width: 600px) 100vw, 600px"><figcaption>Shortest and longest path in a red-black tree</figcaption></figure></div>



<p>The paths to the NIL leaves on the left have a length (excluding the root) of 2. The paths to the NIL leaves on the bottom right have a length of 4.</p>



<h3><span id="Black_Height_of_a_Red-Black_Tree"><span id="Black_Height_of_a_Red-Black_Tree">Black Height of a Red-Black Tree</span></span></h3>



<p>Black height is the number of black nodes from a given node to its leaves. The black NIL leaves are counted, the start node is not.</p>



<p>The black height of the entire tree is the number of black nodes from the root (this is not counted) to the NIL leaves.</p>



<p>The black height of all red-black trees shown so far is 2.</p>



<h2><span id="Red-Black_Tree_Java_Implementation"><span id="Red-Black_Tree_Java_Implementation">Red-Black Tree Java Implementation</span></span></h2>



<p>As a starting point for implementing the red-black tree in Java, I use the <a href="/algorithms/binary-search-tree-java/#Binary_Search_Tree_in_Java">Java source code for the binary search tree</a> from the second part of the binary tree series.</p>



<p>Nodes are represented by the <code><a rel="noopener" href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/Node.java" target="_blank">Node</a></code>&nbsp;class. For simplicity, we use <code>int</code> primitives as the node value.</p>



<p>To implement the red-black tree, besides the child nodes <code>left</code> and <code>right</code>, we need a reference to the parent node and the node's color. We store the color in a <code>boolean</code>, defining red as <code>false</code> and black as <code>true</code>.</p>


<pre class="wp-block-code" aria-describedby="shcb-language-1" data-shcb-language-name="Java" data-shcb-language-slug="java"><style>.wp-block-code {
	border: 0;
	padding: 0;
}

.wp-block-code > div {
	overflow: auto;
}

.shcb-language {
	border: 0;
	clip: rect(1px, 1px, 1px, 1px);
	-webkit-clip-path: inset(50%);
	clip-path: inset(50%);
	height: 1px;
	margin: -1px;
	overflow: hidden;
	padding: 0;
	position: absolute;
	width: 1px;
	word-wrap: normal;
	word-break: normal;
}

.hljs {
	box-sizing: border-box;
}

.hljs.shcb-code-table {
	display: table;
	width: 100%;
}

.hljs.shcb-code-table > .shcb-loc {
	color: inherit;
	display: table-row;
	width: 100%;
}

.hljs.shcb-code-table .shcb-loc > span {
	display: table-cell;
}

.wp-block-code code.hljs:not(.shcb-wrap-lines) {
	white-space: pre;
}

.wp-block-code code.hljs.shcb-wrap-lines {
	white-space: pre-wrap;
}

.hljs.shcb-line-numbers {
	border-spacing: 0;
	counter-reset: line;
}

.hljs.shcb-line-numbers > .shcb-loc {
	counter-increment: line;
}

.hljs.shcb-line-numbers .shcb-loc > span {
	padding-left: 0.75em;
}

.hljs.shcb-line-numbers .shcb-loc::before {
	border-right: 1px solid #ddd;
	content: counter(line);
	display: table-cell;
	padding: 0 0.75em;
	text-align: right;
	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	user-select: none;
	white-space: nowrap;
	width: 1%;
}
</style><div><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span> </span>{
  <span class="hljs-keyword">int</span> data;

  Node left;
  Node right;
  Node parent;

  <span class="hljs-keyword">boolean</span> color;

  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Node</span><span class="hljs-params">(<span class="hljs-keyword">int</span> data)</span> </span>{
    <span class="hljs-keyword">this</span>.data = data;
  }
}</code></div><small class="shcb-language" id="shcb-language-1"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Java</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">java</span><span class="shcb-language__paren">)</span></small></pre>


<p>We implement the red-black tree in the <code><a rel="noopener" href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/RedBlackTree.java" target="_blank">RedBlackTree</a></code> class. This class extends the <code><a rel="noopener" href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/BaseBinaryTree.java" target="_blank">BaseBinaryTree</a></code> class presented in the second part of the series (which essentially provides a <code>getRoot()</code> function).</p>



<p>We will add the operations (insert, search, delete) in the following sections, step by step.</p>



<p>But first, we have to define some helper functions.</p>



<h2><span id="Red_Black_Tree_Rotation"><span id="Red_Black_Tree_Rotation">Red Black Tree Rotation</span></span></h2>



<p><a href="/algorithms/binary-search-tree-java/#Binary_Search_Tree_Insertion">Insertion</a> and <a href="/algorithms/binary-search-tree-java/#Binary_Search_Tree_Deletion">deletion</a> work basically as described in the article about binary search trees.</p>



<p>After insertion and deletion, the red-black rules (<a href="#Red-Black_Tree_Properties">see above</a>) are reviewed. If they have been violated, they must be restored. That happens by recoloring nodes and by rotations.</p>



<p>The rotation works precisely like with <a href="/algorithms/avl-tree-java/">AVL trees</a>, which I described in the previous tutorial. I'll show you the corresponding diagrams again here. You can find detailed explanations in the section <a href="/algorithms/avl-tree-java/#AVL_Tree_Rotation">"AVL tree rotation"</a> of the article just mentioned.</p>



<h3><span id="Right_Rotation"><span id="Right_Rotation">Right Rotation</span></span></h3>



<p>The following graphic shows a right rotation. The colors have no relation to those of the red-black tree. They are only used to track the node movements better.</p>



<p>The left node <em>L</em> becomes the new root; the root <em>N</em> becomes its right child. The right child <em>LR</em> of the pre-rotation left node <em>L</em> becomes the left child of the post-rotation right node <em>N</em>. The two white nodes <em>LL</em> and <em>R</em> do not change their relative position.</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x228" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22228%22%20viewBox%3D%220%200%20800%20228%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23fff%22%20d%3D%22M0%200h800v225H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22translate(1.6%201.6)%20scale(3.125)%22%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%3E%3Cellipse%20cx%3D%22163%22%20cy%3D%2224%22%20rx%3D%2214%22%20ry%3D%2214%22%2F%3E%3Cpath%20d%3D%22M182%2030l-37-5%2024-4z%22%2F%3E%3Cellipse%20cx%3D%22235%22%20cy%3D%2211%22%20rx%3D%2212%22%20ry%3D%2212%22%2F%3E%3Cpath%20d%3D%22M248%2065h5v7h-5z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="228" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-right-rotation-800x228.png" alt="Right rotation in a red-black tree" class="wp-image-22416" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-right-rotation-800x228.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-right-rotation-224x64.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-right-rotation-336x96.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-right-rotation-504x144.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-right-rotation-672x192.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-right-rotation-400x114.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-right-rotation-600x171.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-right-rotation-944x269.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-right-rotation-1200x342.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-right-rotation.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Right rotation in a red-black tree</figcaption></figure></div>



<p>The Java code is slightly longer than in the AVL tree – for the following two reasons:</p>



<ol><li>We also need to update the <code>parent</code> references of the nodes (in the AVL tree, we worked without <code>parent</code> references).</li><li><span style="color: initial;">We need to update the references to and from the pre-rotation top node's parent (<em>N</em>&nbsp;in the graphic). For the AVL tree, we did that indirectly by returning the new root of the rotated subtree and "hooking" the rotation into the recursive call of the insert and delete operations.</span></li></ol>



<p>You can find the implementation of the right rotation in the <a rel="noopener" href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/RedBlackTree.java#L358" target="_blank">source code starting at line 358</a>:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-2" data-shcb-language-name="Java" data-shcb-language-slug="java"><div><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">rotateRight</span><span class="hljs-params">(Node node)</span> </span>{
  Node parent = node.parent;
  Node leftChild = node.left;

  node.left = leftChild.right;
  <span class="hljs-keyword">if</span> (leftChild.right != <span class="hljs-keyword">null</span>) {
    leftChild.right.parent = node;
  }

  leftChild.right = node;
  node.parent = leftChild;

  replaceParentsChild(parent, node, leftChild);
}</code></div><small class="shcb-language" id="shcb-language-2"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Java</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">java</span><span class="shcb-language__paren">)</span></small></pre>


<p>The <code>replaceParentsChild()</code> method called at the end sets the parent-child relationship between the parent node of the former root node <em>N</em> of the rotated subtree and its new root node <em>L</em>. You can find it <a href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/RedBlackTree.java#L388" target="_blank" rel="noopener">in the code starting at line 388</a>:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-3" data-shcb-language-name="Java" data-shcb-language-slug="java"><div><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">replaceParentsChild</span><span class="hljs-params">(Node parent, Node oldChild, Node newChild)</span> </span>{
  <span class="hljs-keyword">if</span> (parent == <span class="hljs-keyword">null</span>) {
    root = newChild;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (parent.left == oldChild) {
    parent.left = newChild;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (parent.right == oldChild) {
    parent.right = newChild;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalStateException(<span class="hljs-string">"Node is not a child of its parent"</span>);
  }

  <span class="hljs-keyword">if</span> (newChild != <span class="hljs-keyword">null</span>) {
    newChild.parent = parent;
  }
}</code></div><small class="shcb-language" id="shcb-language-3"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Java</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">java</span><span class="shcb-language__paren">)</span></small></pre>


<h3><span id="Left_Rotation"><span id="Left_Rotation">Left Rotation</span></span></h3>



<p>Left rotation works analogously: The right node <em>R</em> moves up to the top. The root <em>N</em> becomes the left child of <em>R</em>. The left child <em>RL</em> of the formerly right node <em>R</em> becomes the right child of the post-rotation left node <em>N</em>. <em>L</em> and <em>RR</em> do not change their relative position.</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x228" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22228%22%20viewBox%3D%220%200%20800%20228%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23fff%22%20d%3D%22M0%200h800v225H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22translate(1.6%201.6)%20scale(3.125)%22%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%3E%3Cellipse%20cx%3D%2218%22%20cy%3D%2257%22%20rx%3D%2218%22%20ry%3D%2223%22%2F%3E%3Cpath%20d%3D%22M153.5%2043.7l11.7-10.9%201.3%201.5-11.7%2010.9zM68%2011l-22%206%2014%2011zM9%2055h6v17H9z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="228" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-left-rotation-v2-800x228.png" alt="Left rotation in a red-black tree" class="wp-image-22415" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-left-rotation-v2-800x228.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-left-rotation-v2-224x64.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-left-rotation-v2-336x96.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-left-rotation-v2-504x144.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-left-rotation-v2-672x192.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-left-rotation-v2-400x114.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-left-rotation-v2-600x171.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-left-rotation-v2-944x269.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-left-rotation-v2-1200x342.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-left-rotation-v2.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Left rotation in a red-black tree</figcaption></figure></div>



<p>Here is the Java code for the left rotation (<a rel="noopener" href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/RedBlackTree.java#L373" target="_blank">source code, starting at line 373</a>):</p>


<pre class="wp-block-code" aria-describedby="shcb-language-4" data-shcb-language-name="Java" data-shcb-language-slug="java"><div><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">rotateLeft</span><span class="hljs-params">(Node node)</span> </span>{
  Node parent = node.parent;
  Node rightChild = node.right;

  node.right = rightChild.left;
  <span class="hljs-keyword">if</span> (rightChild.left != <span class="hljs-keyword">null</span>) {
    rightChild.left.parent = node;
  }

  rightChild.left = node;
  node.parent = rightChild;

  replaceParentsChild(parent, node, rightChild);
}</code></div><small class="shcb-language" id="shcb-language-4"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Java</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">java</span><span class="shcb-language__paren">)</span></small></pre>


<h2><span id="Red-Black_Tree_Operations"><span id="Red-Black_Tree_Operations">Red-Black Tree Operations</span></span></h2>



<p>Like any binary tree, the red-black tree provides operations to find, insert, and delete nodes. We will go through these operations step by step in the following sections.</p>



<p>At this point, I would like to recommend the <a rel="noopener" href="https://www.cs.usfca.edu/~galles/visualization/RedBlack.html" target="_blank">red-black tree simulator by David Galles</a>. It allows you to animate any insert, delete and search operations graphically.</p>



<h3><span id="Red-Black_Tree_Search"><span id="Red-Black_Tree_Search">Red-Black Tree Search</span></span></h3>



<p>The search works like in any binary search tree: We first compare the search key with the root. If the search key is smaller, we continue the search in the left subtree; if the search key is larger, we continue the search in the right subtree.</p>



<p>We repeat this until we either find the node we are looking for – or until we reach a NIL leaf (in Java code: a <code>null</code> reference). Reaching a NIL leaf would mean that the key we are looking for does not exist in the tree.</p>



<p>For a graphical representation of the search, see the example in the <a href="/algorithms/binary-search-tree-java/#Binary_Search_Tree_Example">article about binary search trees</a>.</p>



<p>For the red-black tree, we implement an iterative variant of the search. You can find it in the <a href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/RedBlackTree.java#L14" target="_blank" rel="noopener">source code starting at line 14</a>:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-5" data-shcb-language-name="Java" data-shcb-language-slug="java"><div><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">public</span> Node <span class="hljs-title">searchNode</span><span class="hljs-params">(<span class="hljs-keyword">int</span> key)</span> </span>{
  Node node = root;
  <span class="hljs-keyword">while</span> (node != <span class="hljs-keyword">null</span>) {
    <span class="hljs-keyword">if</span> (key == node.data) {
      <span class="hljs-keyword">return</span> node;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key &lt; node.data) {
      node = node.left;
    } <span class="hljs-keyword">else</span> {
      node = node.right;
    }
  }

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
}</code></div><small class="shcb-language" id="shcb-language-5"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Java</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">java</span><span class="shcb-language__paren">)</span></small></pre>


<p>This code should be self-explanatory.</p>



<p>In the <a href="/algorithms/binary-search-tree-java/#Searching">"Searching" section</a> of the article mentioned above, you can also find a recursive version of the search.</p>



<h3><span id="Red-Black_Tree_Insertion"><span id="Red-Black_Tree_Insertion">Red-Black Tree Insertion</span></span></h3>



<p>To insert a new node, we first proceed as described in the <a href="/algorithms/binary-search-tree-java/#Binary_Search_Tree_Insertion">"binary search tree insertion"</a> section of the corresponding article. I.e., we search for the insertion position from the root downwards and attach the new node to a leaf or half-leaf.</p>



<p>You can find the code in the <a rel="noopener" href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/RedBlackTree.java#L29" target="_blank"><code>RedBlackTree</code> class, starting at line 29</a>:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-6" data-shcb-language-name="Java" data-shcb-language-slug="java"><div><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">insertNode</span><span class="hljs-params">(<span class="hljs-keyword">int</span> key)</span> </span>{
  Node node = root;
  Node parent = <span class="hljs-keyword">null</span>;

  <span class="hljs-comment">// Traverse the tree to the left or right depending on the key</span>
  <span class="hljs-keyword">while</span> (node != <span class="hljs-keyword">null</span>) {
    parent = node;
    <span class="hljs-keyword">if</span> (key &lt; node.data) {
      node = node.left;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key &gt; node.data) {
      node = node.right;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">"BST already contains a node with key "</span> + key);
    }
  }

  <span class="hljs-comment">// Insert new node</span>
  Node newNode = <span class="hljs-keyword">new</span> Node(key);
  newNode.color = RED;
  <span class="hljs-keyword">if</span> (parent == <span class="hljs-keyword">null</span>) {
    root = newNode;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key &lt; parent.data) {
    parent.left = newNode;
  } <span class="hljs-keyword">else</span> {
    parent.right = newNode;
  }
  newNode.parent = parent;

  fixRedBlackPropertiesAfterInsert(newNode);
}
</code></div><small class="shcb-language" id="shcb-language-6"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Java</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">java</span><span class="shcb-language__paren">)</span></small></pre>


<p>We initially color the new node red so that rule 5 is satisfied, i.e., all paths have the same number of black nodes after insertion.</p>



<p>However, if the parent node of the inserted node is also red, we have violated rule 4. We then have to repair the tree by recoloring and/or rotating it so that all rules are satisfied again. That is done in the <code>fixRedBlackPropertiesAfterInsert()</code> method, which is called in the last line of the <code>insertNode()</code> method.</p>



<p>During the repair, we have to deal with five different cases:</p>



<ul><li>Case 1: New node is the root</li><li><span style="color: initial;">Case 2: Parent node is red and the root</span></li><li>Case 3: Parent and uncle nodes are red</li><li>Case 4: Parent node is red, uncle node is black, inserted node is "inner grandchild"</li><li>Case 5: Parent node is red, uncle node is black, inserted node is "outer grandchild"</li></ul>



<p>The five cases are described below.</p>



<h4><span id="Case_1_New_Node_Is_the_Root"><span id="Case_1_New_Node_Is_the_Root">Case 1: New Node Is the Root</span></span></h4>



<p>If the new node is the root, we don't have to do anything else. Unless we work with rule 2 ("the root is always black"). In that case, we would have to color the root black.</p>



<h4><span id="Case_2_Parent_Node_Is_Red_and_the_Root"><span id="Case_2_Parent_Node_Is_Red_and_the_Root">Case 2: Parent Node Is Red and the Root</span></span></h4>



<p>In this case, rule 4 ("no red-red!") is violated. All we have to do now is to color the root black. That leads to rule 4 being complied with again.</p>



<div class="wp-block-image"><figure class="aligncenter size-half_600"><img data-lazyloaded="1" data-placeholder-resp="600x130" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22600%22%20height%3D%22130%22%20viewBox%3D%220%200%20600%20130%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23f1f1f1%22%20d%3D%22M0%200h600v128H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23d1d1d1%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(103.61624%20155.366%20-45.98115%2030.66561%20136.4%2065.8)%22%2F%3E%3Cellipse%20fill%3D%22%23d1d1d1%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(43.73942%20-22.41586%2075.20617%20146.74767%20458%2041.4)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(128.93934%20102.19606%20-42.90073%2054.12725%20315.4%2087.3)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(49.09325%20-18.67561%20107.451%20282.46026%20579.5%2061.8)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="600" height="130" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-recolor-red-root-600x130.png" alt="Red-black tree insertion: Recoloring a red root" class="wp-image-22488" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-recolor-red-root-600x130.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-recolor-red-root-224x49.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-recolor-red-root-336x73.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-recolor-red-root-504x109.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-recolor-red-root-672x146.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-recolor-red-root-400x87.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-recolor-red-root-800x173.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-recolor-red-root-944x205.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-recolor-red-root.png 1200w" data-sizes="(max-width: 600px) 100vw, 600px"><figcaption>Recoloring a red root</figcaption></figure></div>



<p>And rule 5? Since the root is not counted in this rule, all paths still have one black node (the NIL leaves not displayed in the graphic). And if we would count the root, then all paths would now have two black nodes instead of one – that would also be allowed.</p>



<p>If we work with rule 2 ("the root is always black"), we have already colored the root black in case 1, and case 2 can no longer occur.</p>



<h4><span id="Case_3_Parent_and_Uncle_Nodes_Are_Red"><span id="Case_3_Parent_and_Uncle_Nodes_Are_Red">Case 3: Parent and Uncle Nodes Are Red</span></span></h4>



<p>We use the term "uncle node" to refer to the sibling of the parent node; that is, the second child of the grandparent node next to the parent node. The following graphic should make this understandable: Inserted was the 81; its parent is the 75, the grandparent is the 19, and the uncle is the 18.</p>



<p>Both the parent and the uncle are red. In this case, we do the following:</p>



<p>We recolor parent and uncle nodes (18 and 75 in the example) black and the grandparent (19) red. Thus rule 4 ("no red-red!") is satisfied again at the inserted node. The number of black nodes per path does not change (in the example, it remains at 2).</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x259" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22259%22%20viewBox%3D%220%200%20800%20259%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23efefef%22%20d%3D%22M0%200h800v256H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(207.05109%20237.45855%20-88.89827%2077.51451%20523%20241)%22%2F%3E%3Cellipse%20fill%3D%22%23d2d2d2%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-38.9%20147.5%20-222.7)%20scale(88.07384%20240.55119)%22%2F%3E%3Cellipse%20fill%3D%22%23d3d3d3%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(129.1%20314.8%20200.2)%20scale(79.28411%20444.3452)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(22.9527%20-108.91838%20201.58566%2042.48076%201.5%20197.9)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="259" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-red-uncle-recolor-800x259.png" alt="Red-black tree insertion: recoloring parent, grandparent, and uncle" class="wp-image-22490" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-red-uncle-recolor-800x259.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-red-uncle-recolor-224x73.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-red-uncle-recolor-336x109.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-red-uncle-recolor-504x163.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-red-uncle-recolor-672x218.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-red-uncle-recolor-400x130.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-red-uncle-recolor-600x194.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-red-uncle-recolor-944x306.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-red-uncle-recolor-1200x389.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-insert-red-uncle-recolor.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Recoloring parent, grandparent, and uncle</figcaption></figure></div>



<p>However, there could now be two red nodes in a row at the grandparent node – namely, if the great-grandparent node (17 in the example) were also red. In this case, we would have to make further repairs. We would do this by calling the repair function recursively on the grandparent node.</p>



<h4><span id="Case_4_Parent_Node_Is_Red_Uncle_Node_Is_Black_Inserted_Node_Is_Inner_Grandchild"><span id="Case_4_Parent_Node_Is_Red_Uncle_Node_Is_Black_Inserted_Node_Is_Inner_Grandchild">Case 4: Parent Node Is Red, Uncle Node Is Black, Inserted Node Is "Inner Grandchild"</span></span></h4>



<p>I must first explain this case: "inner grandchild" means that the path from the grandparent node to the inserted node forms a triangle, as shown in the following graphic using 19, 75, and 24. In this example, you can see that a NIL leaf is also considered a black uncle (according to rule 3).</p>



<p>(For the sake of clarity, I have not drawn the two NIL leaves of the 9 and the 24, as well as the right NIL leaf of the 75.)</p>



<div class="wp-block-image"><figure class="aligncenter size-half_600"><img data-lazyloaded="1" data-placeholder-resp="600x261" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22600%22%20height%3D%22261%22%20viewBox%3D%220%200%20600%20261%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23f6f6f6%22%20d%3D%22M0%200h600v260H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22translate(1.2%201.2)%20scale(2.34375)%22%20fill-opacity%3D%22.5%22%3E%3Cellipse%20fill%3D%22%23cecece%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(28.85486%20-12.54645%2037.99326%2087.37851%20145.3%2032.2)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20cx%3D%2242%22%20cy%3D%2296%22%20rx%3D%2295%22%20ry%3D%2295%22%2F%3E%3Cellipse%20fill%3D%22%23cfcfcf%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-16.03526%20-15.86821%2013.97382%20-14.12093%2096.9%2013.4)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20cx%3D%22223%22%20cy%3D%2253%22%20rx%3D%2233%22%20ry%3D%22255%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="600" height="261" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-600x261.png" alt="Red-black tree insertion: Black uncle, inserted node is &quot;inner&quot; grandchild" class="wp-image-22468" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-600x261.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-224x97.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-336x146.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-504x219.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-672x292.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-400x174.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-800x348.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-944x411.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild.png 1200w" data-sizes="(max-width: 600px) 100vw, 600px"><figcaption>Case 4: Black uncle, inserted node is "inner" grandchild</figcaption></figure></div>



<p>In this case, we first rotate at the parent node in the <em>opposite direction of the inserted node</em>.</p>



<p>What does that mean?</p>



<p>If the inserted node is the <em>left</em> child of its parent node, we rotate to the <em>right</em> at the parent node. If the inserted node is the <em>right</em> child, we rotate to the <em>left</em>.</p>



<p>In the example, the inserted node (the 24) is a left child, so we rotate to the right at the parent node (75 in the example):</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x261" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22261%22%20viewBox%3D%220%200%20800%20261%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23f2f2f2%22%20d%3D%22M0%200h800v259H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22translate(1.6%201.6)%20scale(3.125)%22%20fill-opacity%3D%22.5%22%3E%3Cellipse%20fill%3D%22%23d2d2d2%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-60.42513%20-36.08639%2012.0817%20-20.2303%2030.8%208.5)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(41.5%20-7.8%20242.1)%20scale(86.23992%2047.63745)%22%2F%3E%3Cellipse%20fill%3D%22%23d4d4d4%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(12.76079%20-14.37282%20179.07006%20158.98584%20219%2025.6)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20cx%3D%2221%22%20cy%3D%2263%22%20rx%3D%2236%22%20ry%3D%2236%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="261" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate1-800x261.png" alt="Red-black tree insertion: Right rotation around parent node" class="wp-image-22469" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate1-800x261.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate1-224x73.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate1-336x110.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate1-504x164.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate1-672x219.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate1-400x131.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate1-600x196.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate1-944x308.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate1-1200x392.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate1.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Step 1: Right rotation around parent node</figcaption></figure></div>



<p>Second, we rotate at the grandparent node in the&nbsp;<em>opposite direction</em>&nbsp;to the previous rotation. In the example, we rotate left around the 19:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-lazyloaded="1" data-placeholder-resp="1600x458" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%221600%22%20height%3D%22458%22%20viewBox%3D%220%200%201600%20458%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23f1f1f1%22%20d%3D%22M0%200h1600v456H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22matrix(6.25%200%200%206.25%203.1%203.1)%22%20fill-opacity%3D%22.5%22%3E%3Cellipse%20fill%3D%22%23d1d1d1%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(6.63995%20-25.5279%2071.63335%2018.63223%20225.3%2022.3)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-145.7%20107.3%206.3)%20scale(151.55687%2030.224)%22%2F%3E%3Cellipse%20fill%3D%22%23d0d0d0%22%20cx%3D%2213%22%20cy%3D%228%22%20rx%3D%2258%22%20ry%3D%2219%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-7.33234%20-35.78398%2050.8581%20-10.42111%2026.5%2062)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="1600" height="458" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate2.png" alt="Red-black tree insertion: Left rotation around grandparent" class="wp-image-22470" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate2.png 1600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate2-224x64.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate2-336x96.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate2-504x144.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate2-672x192.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate2-400x115.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate2-600x172.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate2-800x229.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate2-944x270.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-rotate2-1200x344.png 1200w" data-sizes="(max-width: 1600px) 100vw, 1600px"><figcaption>Step 2: Left rotation around grandparent</figcaption></figure></div>



<p>Finally, we color the node we just inserted (the 24 in the example) black and the original grandparent (the 19 in the example) red:</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x160" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22160%22%20viewBox%3D%220%200%20800%20160%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23e7e7e7%22%20d%3D%22M0%200h800v159H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-21.4%20539.4%20-1076.5)%20scale(74.81497%20328.31689)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-65.10615%2028.09364%20-97.47652%20-225.89883%20425.9%20100.4)%22%2F%3E%3Cellipse%20fill%3D%22%23dadada%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(54.9052%20-95.39735%20167.03176%2096.13383%20180%2062)%22%2F%3E%3Cellipse%20fill%3D%22%23d9d9d9%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(88.71982%20-71.18249%20174.96738%20218.07436%20657.6%20110)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="160" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-recolor-800x160.png" alt="Red-black tree insertion: Recoloring the inserted node and the initial grandparent" class="wp-image-22471" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-recolor-800x160.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-recolor-224x45.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-recolor-336x67.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-recolor-504x101.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-recolor-672x134.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-recolor-400x80.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-recolor-600x120.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-recolor-944x189.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-recolor-1200x240.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-inner-grandchild-recolor.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Step 3: Recoloring the inserted node and the initial grandparent</figcaption></figure></div>



<p>Since there is now a black node at the top of the last rotated subtree, there cannot be a violation of rule 4 ("no red-red!") at that position.</p>



<p>Also, recoloring the original grandparent (19) red cannot violate rule 4. Its left child is the uncle, which is black by definition of this case. And the right child, as a result of the second rotation, is the left child of the inserted node, thus a black NIL leaf.</p>



<p>The inserted red 75 has two NIL leaves as children, so there is no violation of rule 4 here either.</p>



<p>The repair is now complete; a recursive call of the repair function is not necessary.</p>



<h4><span id="Case_5_Parent_Node_Is_Red_Uncle_Node_Is_Black_Inserted_Node_Is_Outer_Grandchild"><span id="Case_5_Parent_Node_Is_Red_Uncle_Node_Is_Black_Inserted_Node_Is_Outer_Grandchild">Case 5: Parent Node Is Red, Uncle Node Is Black, Inserted Node Is "Outer Grandchild"</span></span></h4>



<p>"Outer grandchild" means that the path from grandparent to inserted node forms a line, such as the 19, 75, and 81 in the following example:</p>



<div class="wp-block-image"><figure class="aligncenter size-half_600"><img data-lazyloaded="1" data-placeholder-resp="600x262" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22600%22%20height%3D%22262%22%20viewBox%3D%220%200%20600%20262%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23f6f6f6%22%20d%3D%22M0%200h600v260H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22translate(1.2%201.2)%20scale(2.34375)%22%20fill-opacity%3D%22.5%22%3E%3Cellipse%20fill%3D%22%23ccc%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(70.479%2080.95008%20-20.3686%2017.73388%20135%2029.7)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20cx%3D%2237%22%20cy%3D%22110%22%20rx%3D%22103%22%20ry%3D%22103%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(59.3%2080%20218.4)%20scale(156.10077%2042.93522)%22%2F%3E%3Cellipse%20fill%3D%22%23dadada%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(20.52671%2021.0345%20-15.3325%2014.96235%2096.1%2011.5)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="600" height="262" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-600x262.png" alt="Red-black tree insertion: Black uncle, inserted node is &quot;outer&quot; grandson" class="wp-image-22459" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-600x262.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-224x98.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-336x147.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-504x220.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-672x293.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-400x175.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-800x349.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-944x412.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild.png 1200w" data-sizes="(max-width: 600px) 100vw, 600px"><figcaption>Case 5: Black uncle, inserted node is "outer" grandson</figcaption></figure></div>



<p>In this case, we rotate at the grandparent (19 in the example) in the <em>opposite direction of the parent and inserted node</em> (after all, both go in the same direction in this case). In the example, the parent and inserted nodes are both <em>right</em> children, so we rotate <em>left</em> at the grandparent:</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x260" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22260%22%20viewBox%3D%220%200%20800%20260%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23f3f3f3%22%20d%3D%22M0%200h800v259H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23cecece%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-28.84981%20100.36517%20-225.0256%20-64.68326%20694.8%2040.6)%22%2F%3E%3Cpath%20fill%3D%22%23cfcfcf%22%20fill-opacity%3D%22.5%22%20d%3D%22M311%20142.2L251.5-48.4l-300%2065.6z%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-48.4%20476.8%20-472.8)%20scale(113.09645%20303.84393)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(107.88953%20-128.63981%20113.62247%2095.29456%20101.8%20238.5)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="260" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-rotate-800x260.png" alt="Red-black tree insertion: Left rotation around grandparent" class="wp-image-22461" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-rotate-800x260.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-rotate-224x73.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-rotate-336x109.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-rotate-504x164.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-rotate-672x218.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-rotate-400x130.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-rotate-600x195.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-rotate-944x307.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-rotate-1200x390.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-rotate.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Step 1: Left rotation around grandparent</figcaption></figure></div>



<p>Then we recolor the former parent (75 in the example) black and the former grandparent (19) red:</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x160" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22160%22%20viewBox%3D%220%200%20800%20160%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23e7e7e7%22%20d%3D%22M0%200h800v159H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(125.13532%20262.2317%20-66.60344%2031.78274%20439%20128.5)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(72.41491%20-23.31531%2098.11521%20304.73555%20432.7%20131.9)%22%2F%3E%3Cellipse%20fill%3D%22%23dadada%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-151.6%20104.1%2014.9)%20scale(177.27308%20113.60552)%22%2F%3E%3Cellipse%20fill%3D%22%23dadada%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(171.4186%2097.3636%20-48.5442%2085.46706%20649.5%2092)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="160" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-recolor-800x160.png" alt="Red-black tree insertion: Recoloring former parent and grandparent" class="wp-image-22464" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-recolor-800x160.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-recolor-224x45.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-recolor-336x67.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-recolor-504x101.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-recolor-672x134.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-recolor-400x80.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-recolor-600x120.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-recolor-944x189.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-recolor-1200x240.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-black-uncle-outer-grandchild-recolor.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Step 2: Recoloring former parent and grandparent</figcaption></figure></div>



<p>As at the end of case 4, we have a black node at the top of the rotation, so there can be no violation of rule 4 ("no red-red!") there.</p>



<p>The left child of the 19 is the original uncle after rotation, so it is black by case definition. The right child of the 19 is the original left child of the parent node (75), which must also be a black NIL leaf; otherwise, the right place where we inserted the 81 would not have been free (because a red node always has either two black children with value or two black NIL children).</p>



<p>The red 81 is the inserted node and, therefore, also has two black NIL leaves.</p>



<p>At this point, we've completed the repair of the red-black tree.</p>



<p>If you have paid close attention, you will notice that case 5 corresponds precisely to the second rotation from case 4. In the code, this will be shown by the fact that only the first rotation is implemented for case 4, and then the program jumps to the code for case 5.</p>



<h4><span id="Implementation_of_the_Post-Insertion_Repair_Method"><span id="Implementation_of_the_Post-Insertion_Repair_Method">Implementation of the Post-Insertion Repair Method</span></span></h4>



<p>You can find the complete repair function in <a rel="noopener" href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/RedBlackTree.java#L64" target="_blank"><code>RedBlackTree</code> starting at line 64</a>. I have marked cases 1 to 5 by comments. Cases 4 and 5 are split into 4a/4b and 5a/5b depending on whether the parent node is left (4a/5a) or right child (4b/5b) of the grandparent node.</p>


<pre class="wp-block-code" aria-describedby="shcb-language-7" data-shcb-language-name="Java" data-shcb-language-slug="java"><div><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">fixRedBlackPropertiesAfterInsert</span><span class="hljs-params">(Node node)</span> </span>{
  Node parent = node.parent;

  <span class="hljs-comment">// Case 1: Parent is null, we've reached the root, the end of the recursion</span>
  <span class="hljs-keyword">if</span> (parent == <span class="hljs-keyword">null</span>) {
    <span class="hljs-comment">// Uncomment the following line if you want to enforce black roots (rule 2):</span>
    <span class="hljs-comment">// node.color = BLACK;</span>
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// Parent is black --&gt; nothing to do</span>
  <span class="hljs-keyword">if</span> (parent.color == BLACK) {
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// From here on, parent is red</span>
  Node grandparent = parent.parent;

  <span class="hljs-comment">// Case 2:</span>
  <span class="hljs-comment">// Not having a grandparent means that parent is the root. If we enforce black roots</span>
  <span class="hljs-comment">// (rule 2), grandparent will never be null, and the following if-then block can be</span>
  <span class="hljs-comment">// removed.</span>
  <span class="hljs-keyword">if</span> (grandparent == <span class="hljs-keyword">null</span>) {
    <span class="hljs-comment">// As this method is only called on red nodes (either on newly inserted ones - or -</span>
    <span class="hljs-comment">// recursively on red grandparents), all we have to do is to recolor the root black.</span>
    parent.color = BLACK;
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// Get the uncle (may be null/nil, in which case its color is BLACK)</span>
  Node uncle = getUncle(parent);

  <span class="hljs-comment">// Case 3: Uncle is red -&gt; recolor parent, grandparent and uncle</span>
  <span class="hljs-keyword">if</span> (uncle != <span class="hljs-keyword">null</span> &amp;&amp; uncle.color == RED) {
    parent.color = BLACK;
    grandparent.color = RED;
    uncle.color = BLACK;

    <span class="hljs-comment">// Call recursively for grandparent, which is now red.</span>
    <span class="hljs-comment">// It might be root or have a red parent, in which case we need to fix more...</span>
    fixRedBlackPropertiesAfterInsert(grandparent);
  }

  <span class="hljs-comment">// Parent is left child of grandparent</span>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (parent == grandparent.left) {
    <span class="hljs-comment">// Case 4a: Uncle is black and node is left-&gt;right "inner child" of its grandparent</span>
    <span class="hljs-keyword">if</span> (node == parent.right) {
      rotateLeft(parent);

      <span class="hljs-comment">// Let "parent" point to the new root node of the rotated sub-tree.</span>
      <span class="hljs-comment">// It will be recolored in the next step, which we're going to fall-through to.</span>
      parent = node;
    }

    <span class="hljs-comment">// Case 5a: Uncle is black and node is left-&gt;left "outer child" of its grandparent</span>
    rotateRight(grandparent);

    <span class="hljs-comment">// Recolor original parent and grandparent</span>
    parent.color = BLACK;
    grandparent.color = RED;
  }

  <span class="hljs-comment">// Parent is right child of grandparent</span>
  <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Case 4b: Uncle is black and node is right-&gt;left "inner child" of its grandparent</span>
    <span class="hljs-keyword">if</span> (node == parent.left) {
      rotateRight(parent);

      <span class="hljs-comment">// Let "parent" point to the new root node of the rotated sub-tree.</span>
      <span class="hljs-comment">// It will be recolored in the next step, which we're going to fall-through to.</span>
      parent = node;
    }

    <span class="hljs-comment">// Case 5b: Uncle is black and node is right-&gt;right "outer child" of its grandparent</span>
    rotateLeft(grandparent);

    <span class="hljs-comment">// Recolor original parent and grandparent</span>
    parent.color = BLACK;
    grandparent.color = RED;
  }
}</code></div><small class="shcb-language" id="shcb-language-7"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Java</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">java</span><span class="shcb-language__paren">)</span></small></pre>


<p>You will find the helper function <code>getUncle()</code> <a href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/RedBlackTree.java#L152" target="_blank" rel="noopener">starting at line 152</a>:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-8" data-shcb-language-name="Java" data-shcb-language-slug="java"><div><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">private</span> Node <span class="hljs-title">getUncle</span><span class="hljs-params">(Node parent)</span> </span>{
  Node grandparent = parent.parent;
  <span class="hljs-keyword">if</span> (grandparent.left == parent) {
    <span class="hljs-keyword">return</span> grandparent.right;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (grandparent.right == parent) {
    <span class="hljs-keyword">return</span> grandparent.left;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalStateException(<span class="hljs-string">"Parent is not a child of its grandparent"</span>);
  }
}</code></div><small class="shcb-language" id="shcb-language-8"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Java</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">java</span><span class="shcb-language__paren">)</span></small></pre>


<h4><span id="Implementation_Notes"><span id="Implementation_Notes">Implementation Notes</span></span></h4>



<p>Unlike the AVL tree, we cannot easily hook the repair function of the red-black tree into the existing recursion from <a href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/BinarySearchTreeRecursive.java#L34"><code>BinarySearchTreeRecursive</code></a>. That is because we need to rotate not only at the node under which we inserted the new node but also at the grandparent if necessary (cases 3 and 4).</p>



<p>You will find numerous alternative implementations in the literature. These are sometimes minimally more performant than the way presented here since they combine multiple steps. That doesn't change the order of magnitude of the performance, but it can gain a few percent. It was important for me to implement the algorithm in a comprehensible way. The more performant algorithms are always more complex, too.</p>



<p>I implemented the iterative insertion in two steps – search first, then insertion – unlike <a rel="noopener" href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/BinarySearchTreeIterative.java#L26" target="_blank"><code>BinarySearchTreeIterative</code></a>, where I combined the two. That makes reading the code a bit easier but requires an additional "<code>if (key &lt; parent.data)</code>" check to determine whether the new node needs to be inserted as a left or right child under its parent.</p>



<h3><span id="Red-Black_Tree_Deletion"><span id="Red-Black_Tree_Deletion">Red-Black Tree Deletion</span></span></h3>



<p>If you have just finished reading the chapter on inserting, you might want to take a short break. After all, deleting is even more complex.</p>



<p>First, we proceed as described in the <a href="/algorithms/binary-search-tree-java/#Binary_Search_Tree_Deletion">"Binary Search Tree Deletion" section</a> of the article on binary search trees in general.</p>



<p>Here is a summary:</p>



<ol><li>If the node to be deleted has <em>no</em> children, we simply remove it.</li><li>If the node to be deleted has <em>one</em> child, we remove the node and let its single child move up to its position.</li><li>If the node to be deleted has <em>two</em> children, we copy the content (not the color!) of the in-order successor of the right child into the node to be deleted and then delete the in-order successor according to rule 1 or 2 (the in-order successor has at most one child by definition).</li></ol>



<p>After that, we need to check the rules of the tree and repair it if necessary. To do this, we need to remember the deleted node's color and which node we have moved up.</p>



<ul><li>If the deleted node is red, we cannot have violated any rule: Neither can it result in two consecutive red nodes (rule 4), nor does it change the number of black nodes on any path (rule 5).</li><li>However, if the deleted node is black, we are guaranteed to have violated rule 5 (unless the tree contained nothing but a black root), and rule 4 may also have been violated – namely if both parent nodes and the moved-up child of the deleted node were red.</li></ul>



<p>First, here is the code for the actual deletion of a node (<a rel="noopener" href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/RedBlackTree.java#L163" target="_blank">class RedBlackTree, line 163</a>). Underneath the code, I will explain its parts:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-9" data-shcb-language-name="Java" data-shcb-language-slug="java"><div><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">deleteNode</span><span class="hljs-params">(<span class="hljs-keyword">int</span> key)</span> </span>{
  Node node = root;

  <span class="hljs-comment">// Find the node to be deleted</span>
  <span class="hljs-keyword">while</span> (node != <span class="hljs-keyword">null</span> &amp;&amp; node.data != key) {
    <span class="hljs-comment">// Traverse the tree to the left or right depending on the key</span>
    <span class="hljs-keyword">if</span> (key &lt; node.data) {
      node = node.left;
    } <span class="hljs-keyword">else</span> {
      node = node.right;
    }
  }

  <span class="hljs-comment">// Node not found?</span>
  <span class="hljs-keyword">if</span> (node == <span class="hljs-keyword">null</span>) {
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// At this point, "node" is the node to be deleted</span>

  <span class="hljs-comment">// In this variable, we'll store the node at which we're going to start to fix the R-B</span>
  <span class="hljs-comment">// properties after deleting a node.</span>
  Node movedUpNode;
  <span class="hljs-keyword">boolean</span> deletedNodeColor;

  <span class="hljs-comment">// Node has zero or one child</span>
  <span class="hljs-keyword">if</span> (node.left == <span class="hljs-keyword">null</span> || node.right == <span class="hljs-keyword">null</span>) {
    movedUpNode = deleteNodeWithZeroOrOneChild(node);
    deletedNodeColor = node.color;
  }

  <span class="hljs-comment">// Node has two children</span>
  <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Find minimum node of right subtree ("inorder successor" of current node)</span>
    Node inOrderSuccessor = findMinimum(node.right);

    <span class="hljs-comment">// Copy inorder successor's data to current node (keep its color!)</span>
    node.data = inOrderSuccessor.data;

    <span class="hljs-comment">// Delete inorder successor just as we would delete a node with 0 or 1 child</span>
    movedUpNode = deleteNodeWithZeroOrOneChild(inOrderSuccessor);
    deletedNodeColor = inOrderSuccessor.color;
  }

  <span class="hljs-keyword">if</span> (deletedNodeColor == BLACK) {
    fixRedBlackPropertiesAfterDelete(movedUpNode);

    <span class="hljs-comment">// Remove the temporary NIL node</span>
    <span class="hljs-keyword">if</span> (movedUpNode.getClass() == NilNode<span class="hljs-class">.<span class="hljs-keyword">class</span>) </span>{
      replaceParentsChild(movedUpNode.parent, movedUpNode, <span class="hljs-keyword">null</span>);
    }
  }
}</code></div><small class="shcb-language" id="shcb-language-9"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Java</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">java</span><span class="shcb-language__paren">)</span></small></pre>


<p>The first lines of code search for the node to be deleted; the method terminates if that node can't be found.</p>



<p>How to proceed depends on the number of children nodes to be deleted.</p>



<h4><span id="Deleting_a_Node_With_Zero_or_One_Child"><span id="Deleting_a_Node_With_Zero_or_One_Child">Deleting a Node With Zero or One Child</span></span></h4>



<p>If the deleted node has at most one child, we call the method <code>deleteNodeWithZeroOrOneChild()</code>. You can find it in the <a href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/RedBlackTree.java#L221" target="_blank" rel="noopener">source code starting at line 221</a>:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-10" data-shcb-language-name="Java" data-shcb-language-slug="java"><div><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">private</span> Node <span class="hljs-title">deleteNodeWithZeroOrOneChild</span><span class="hljs-params">(Node node)</span> </span>{
  <span class="hljs-comment">// Node has ONLY a left child --&gt; replace by its left child</span>
  <span class="hljs-keyword">if</span> (node.left != <span class="hljs-keyword">null</span>) {
    replaceParentsChild(node.parent, node, node.left);
    <span class="hljs-keyword">return</span> node.left; <span class="hljs-comment">// moved-up node</span>
  }

  <span class="hljs-comment">// Node has ONLY a right child --&gt; replace by its right child</span>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (node.right != <span class="hljs-keyword">null</span>) {
    replaceParentsChild(node.parent, node, node.right);
    <span class="hljs-keyword">return</span> node.right; <span class="hljs-comment">// moved-up node</span>
  }

  <span class="hljs-comment">// Node has no children --&gt;</span>
  <span class="hljs-comment">// * node is red --&gt; just remove it</span>
  <span class="hljs-comment">// * node is black --&gt; replace it by a temporary NIL node (needed to fix the R-B rules)</span>
  <span class="hljs-keyword">else</span> {
    Node newChild = node.color == BLACK ? <span class="hljs-keyword">new</span> NilNode() : <span class="hljs-keyword">null</span>;
    replaceParentsChild(node.parent, node, newChild);
    <span class="hljs-keyword">return</span> newChild;
  }
}</code></div><small class="shcb-language" id="shcb-language-10"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Java</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">java</span><span class="shcb-language__paren">)</span></small></pre>


<p>I have already introduced you to the <code>replaceParentsChild()</code> method (which is called several times here) in the rotation.</p>



<p>The case where the deleted node is black and has no children is a special case. That is dealt with in the last <code>else</code> block:</p>



<p>We have seen above that deleting a black node results in the number of black nodes no longer being the same on all paths. That is, we will have to repair the tree. The tree repair always starts (as you will see shortly) at the moved-up node.</p>



<p>If the deleted node has no children, one of its NIL leaves virtually moves up to its position. To be able to navigate from this NIL leaf to its parent node later, we need a special placeholder. I've implemented one in the class <code>NilNode</code>, which you can find in the <a rel="noopener" href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/RedBlackTree.java#L349" target="_blank">source code starting at line 349</a>:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-11" data-shcb-language-name="Java" data-shcb-language-slug="java"><div><code class="hljs language-java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NilNode</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Node</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">NilNode</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">super</span>(<span class="hljs-number">0</span>);
    <span class="hljs-keyword">this</span>.color = BLACK;
  }
}</code></div><small class="shcb-language" id="shcb-language-11"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Java</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">java</span><span class="shcb-language__paren">)</span></small></pre>


<p>Finally, the <code>deleteNodeWithZeroOrOneChild()</code> method returns the moved-up node that the calling <code>deleteNode()</code> method stores in the <code>movedUpNode</code> variable.</p>



<h4><span id="Deleting_a_Node_With_Two_Children"><span id="Deleting_a_Node_With_Two_Children">Deleting a Node With Two Children</span></span></h4>



<p>If the node to be deleted has two children, we first use the <code>findMinimum()</code> method (<a href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/RedBlackTree.java#L244" target="_blank" rel="noopener">line 244</a>) to find the in-order successor of the subtree that starts at the right child:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-12" data-shcb-language-name="Java" data-shcb-language-slug="java"><div><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">private</span> Node <span class="hljs-title">findMinimum</span><span class="hljs-params">(Node node)</span> </span>{
  <span class="hljs-keyword">while</span> (node.left != <span class="hljs-keyword">null</span>) {
    node = node.left;
  }
  <span class="hljs-keyword">return</span> node;
}</code></div><small class="shcb-language" id="shcb-language-12"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Java</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">java</span><span class="shcb-language__paren">)</span></small></pre>


<p>We then copy the data of the in-order successor into the node to be deleted and call the <code>deleteNodeWithZeroOrOneChild()</code> method introduced above to remove the in-order successor from the tree. Again, we remember the moved-up node in <code>movedUpNode</code>.</p>



<h4><span id="Repairing_the_Tree"><span id="Repairing_the_Tree">Repairing the Tree</span></span></h4>



<p>Here is once more the last <code>if</code>-block of the <code>deleteNode()</code> method:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-13" data-shcb-language-name="Java" data-shcb-language-slug="java"><div><code class="hljs language-java"><span class="hljs-keyword">if</span> (deletedNodeColor == BLACK) {
  fixRedBlackPropertiesAfterDelete(movedUpNode);

  <span class="hljs-comment">// Remove the temporary NIL node</span>
  <span class="hljs-keyword">if</span> (movedUpNode.getClass() == NilNode<span class="hljs-class">.<span class="hljs-keyword">class</span>) </span>{
    replaceParentsChild(movedUpNode.parent, movedUpNode, <span class="hljs-keyword">null</span>);
  }
}</code></div><small class="shcb-language" id="shcb-language-13"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Java</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">java</span><span class="shcb-language__paren">)</span></small></pre>


<p>As stated above, deleting a <em>red</em> node does not violate any rules. If, however, the deleted node is <em>black</em>, we call the repair method <code>fixRedBlackPropertiesAfterDelete()</code>.</p>



<p>If any, we've needed the temporary <code>NilNode</code> placeholder created in <code>deleteNodeWithZeroOrOneChild()</code> only for calling the repair function. We can therefore remove it afterward.</p>



<p>When deleting, we have to consider one more case than when inserting. In contrast to the insertion, the color of the uncle is not relevant here but that of the deleted node's sibling.</p>



<ul><li>Case 1: Deleted node is the root</li><li>Case 2: Sibling is red</li><li>Case 3: Sibling is black and has two black children, parent is red</li><li>Case 4: Sibling is black and has two black children, parent is black</li><li>Case 5: Sibling is black and has at least one red child, "outer nephew" is black</li><li>Case 6: Sibling is black and has at least one red child, "outer nephew" is red</li></ul>



<p>The following sections describe the six cases in detail:</p>



<h4><span id="Case_1_Deleted_Node_Is_the_Root"><span id="Case_1_Deleted_Node_Is_the_Root"><span style="font-size: revert; color: initial;">Case 1: Deleted Node Is the Root</span></span></span></h4>



<p>If we removed the root, another node moved up to its position. That could only happen if the root had zero or only one child. If the root had had two children, it would have been the in-order successor that would have been removed in the end and not the root node.</p>



<p>If the root had <em>no</em> child, the new root is a black NIL node. Thus the tree is empty and valid:</p>



<div class="wp-block-image"><figure class="aligncenter size-half_600"><img data-lazyloaded="1" data-placeholder-resp="600x72" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22600%22%20height%3D%2272%22%20viewBox%3D%220%200%20600%2072%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23f9f9f9%22%20d%3D%22M0%200h600v70H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22translate(1.2%201.2)%20scale(2.34375)%22%20fill-opacity%3D%22.5%22%3E%3Cellipse%20fill%3D%22%23c8c8c8%22%20cx%3D%2234%22%20cy%3D%2210%22%20rx%3D%2224%22%20ry%3D%2294%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20cx%3D%22174%22%20cy%3D%2214%22%20rx%3D%22116%22%20ry%3D%22119%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20cx%3D%22163%22%20cy%3D%2219%22%20rx%3D%22105%22%20ry%3D%22155%22%2F%3E%3Cpath%20fill%3D%22%23dfdfdf%22%20d%3D%22M10%200h47v30H10z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="600" height="72" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1a-600x72.png" alt="Red-black tree deletion: Removing a root without a child" class="wp-image-22541" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1a-600x72.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1a-224x27.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1a-336x40.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1a-504x60.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1a-672x81.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1a-400x48.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1a-800x96.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1a-944x113.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1a.png 1200w" data-sizes="(max-width: 600px) 100vw, 600px"><figcaption>Case 1a: Removing a root without a child</figcaption></figure></div>



<p>If the root had <em>one</em> child, then this had to be red and have no other children.</p>



<p>Explanation: If the red child had another red child, rule 4 ("no red-red!") would have been violated. If the red child had a black child, then the paths through the red node would have at least one more black node than the NIL subtree of the root, and thus rule 5 would have been violated.</p>



<p>Thus, the tree consists of only one red root and is therefore also valid.</p>



<div class="wp-block-image"><figure class="aligncenter size-half_600"><img data-lazyloaded="1" data-placeholder-resp="600x114" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22600%22%20height%3D%22114%22%20viewBox%3D%220%200%20600%20114%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23f4f4f4%22%20d%3D%22M0%200h600v112H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23cfcfcf%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(113.97249%2065.27266%20-24.16523%2042.19488%20142.3%2055.1)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(246.16385%20180.82533%20-47.05304%2064.05495%20409.6%20100.4)%22%2F%3E%3Cellipse%20fill%3D%22%23d0d0d0%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-33.49241%20-33.21088%2033.78456%20-34.07096%20499%2012.7)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(160.6839%20-165.04676%2044.1184%2042.95217%20598.8%2057.8)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="600" height="114" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1b-600x114.png" alt="Red-black tree deletion: Removing a root with one child" class="wp-image-22542" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1b-600x114.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1b-224x43.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1b-336x64.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1b-504x96.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1b-672x128.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1b-400x76.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1b-800x152.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1b-944x179.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-1b.png 1200w" data-sizes="(max-width: 600px) 100vw, 600px"><figcaption>Case 1b: Removing a root with one child</figcaption></figure></div>



<p>Should we work with rule 2 ("the root is always black"), we would now recolor the root.</p>



<h4><span id="Case_2_Sibling_Is_Red"><span id="Case_2_Sibling_Is_Red">Case 2: Sibling Is Red</span></span></h4>



<p>For all other cases, we first check the color of the sibling. That is the second child of the parent of the deleted node. In the following example, we delete the 9; its sibling is the red 19:</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x161" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22161%22%20viewBox%3D%220%200%20800%20161%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23e9e9e9%22%20d%3D%22M0%200h800v159H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-18.9%20282.6%20-1222)%20scale(79.61847%20260.9811)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-151.6%2017%2063.9)%20scale(100.36204%2084.38235)%22%2F%3E%3Cellipse%20fill%3D%22%23d8d8d8%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-204.27986%20-126.97546%2048.87066%20-78.62378%20161%2027.7)%22%2F%3E%3Cellipse%20fill%3D%22%23d8d8d8%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(31.1%20158.4%201230.5)%20scale(170.14598%2097.43399)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="161" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step1-800x161.png" alt="Red-black tree deletion: Red sibling" class="wp-image-22553" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step1-800x161.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step1-224x45.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step1-336x68.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step1-504x101.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step1-672x135.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step1-400x81.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step1-600x121.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step1-944x190.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step1-1200x242.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step1.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Case 2: Red sibling</figcaption></figure></div>



<p>In this case, we first color the sibling black and the parent red:</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x175" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22175%22%20viewBox%3D%220%200%20800%20175%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23ececec%22%20d%3D%22M0%200h800v175H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-93.95918%2029.73832%20-76.031%20-240.22235%20416.6%201.6)%22%2F%3E%3Cellipse%20fill%3D%22%23d5d5d5%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-146.2%20130.5%2016)%20scale(128.40546%20104.63188)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-21.55313%20-342.57722%2094.423%20-5.9406%2017%20112.1)%22%2F%3E%3Cellipse%20fill%3D%22%23d5d5d5%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-33.7%20513.3%20-1005.4)%20scale(101.83903%20141.34637)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="175" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step2-800x175.png" alt="Red-black tree deletion: Red sbiling: Recoloring sibling and parent" class="wp-image-22554" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step2-800x175.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step2-224x49.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step2-336x74.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step2-504x110.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step2-672x147.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step2-400x88.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step2-600x131.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step2-944x207.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step2-1200x263.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step2.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Step 1: Recoloring sibling and parent</figcaption></figure></div>



<p>That obviously violated rule 5: The paths in the right subtree of the parent each have two more black nodes than those in the left subtree. We fix this by rotating around the parent in the direction of the deleted node.</p>



<p>In the example, we have deleted the <em>left</em> node of the parent node – we, therefore, perform a <em>left</em> rotation:</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x174" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22174%22%20viewBox%3D%220%200%20800%20174%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23ececec%22%20d%3D%22M0%200h800v171H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23d5d5d5%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(132.1432%20259.3639%20-98.5689%2050.21983%20263.8%20170.3)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(28.01074%20271.784%20-61.67286%206.35616%2048.3%20123)%22%2F%3E%3Cellipse%20fill%3D%22%23d5d5d5%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(119.9%20260.6%20213.4)%20scale(252.17936%2096.722)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(130.08735%20-206.72099%2066.56104%2041.88616%20791%2080.2)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="174" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step3-800x174.png" alt="Red-black tree deletion: Red sibling: Rotation around the parent" class="wp-image-22555" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step3-800x174.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step3-224x49.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step3-336x73.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step3-504x110.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step3-672x146.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step3-400x87.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step3-600x131.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step3-944x205.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step3-1200x261.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step3.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Step 2: Rotation around the parent</figcaption></figure></div>



<p>Now we have two black nodes on the right path and two on the path to the 18. However, we have <em>only one</em> black node on the path to the left NIL leaf of 17 (remember: the root does not count, the NIL nodes do – even the ones not drawn in the graphic).</p>



<p>We look at the new sibling of the deleted node (18 in the example). That new sibling is now definitely black because it is an original child of the red sibling from the beginning of the case.</p>



<p>Also, the new sibling has black children. Therefore, we color the sibling (the 18) red and the parent (the 17) black:</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x194" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22194%22%20viewBox%3D%220%200%20800%20194%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23f0f0f0%22%20d%3D%22M0%200h800v193H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22translate(1.6%201.6)%20scale(3.125)%22%20fill-opacity%3D%22.5%22%3E%3Cellipse%20fill%3D%22%23d2d2d2%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(3.56752%20-61.25206%2030.31665%201.76574%2053.2%2014.4)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(47.35405%209.738%20-6.42563%2031.24664%20125.3%2046.4)%22%2F%3E%3Cellipse%20fill%3D%22%23d2d2d2%22%20cx%3D%22178%22%20rx%3D%2241%22%20ry%3D%2237%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-38.06005%2026.94802%20-16.49932%20-23.30283%20239%2035.8)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="194" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step4-800x194.png" alt="Red-black tree deletion: Red sibling: Recoloring parent and new sibling" class="wp-image-22556" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step4-800x194.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step4-224x54.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step4-336x81.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step4-504x122.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step4-672x163.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step4-400x97.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step4-600x146.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step4-944x229.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step4-1200x291.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-2-step4.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>(Step 3: Recoloring parent and new sibling)</figcaption></figure></div>



<p>Now all paths have two black nodes; we have a valid red-black tree again.</p>



<h4><span id="Case_2_-_Fall-Through"><span id="Case_2_-_Fall-Through">Case 2 ‒ Fall-Through</span></span></h4>



<p>In fact, I have anticipated something in this last step. Namely, we have executed the rules of case 3 (that's why the image subtitle is in parentheses).</p>



<p>In this last step of case 2, we always have a black sibling. The fact that the black sibling had two black children, as required for case 3, was a coincidence. In fact, at the end of case 2, any of the cases 3 to 6 can occur and must be treated according to the following sections.</p>



<h4><span id="Case_3_Sibling_Is_Black_and_Has_Two_Black_Children_Parent_Is_Red"><span id="Case_3_Sibling_Is_Black_and_Has_Two_Black_Children_Parent_Is_Red">Case 3: Sibling Is Black and Has Two Black Children, Parent Is Red</span></span></h4>



<p>In the following example, we delete the 75 and let one of its black NIL leaves move up.</p>



<p>(Again, as a reminder: I only show NIL nodes in the graphics when they are relevant for understanding.)</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x161" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22161%22%20viewBox%3D%220%200%20800%20161%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23e1e1e1%22%20d%3D%22M0%200h800v159H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(51.59392%2039.44653%20-42.9949%2056.23499%20390.3%201.7)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(57.63604%20-14.3348%2012.86%2051.70634%20389.3%2012.3)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-32.35157%20-36.19434%2056.3595%20-50.37578%20395%201.6)%22%2F%3E%3Cpath%20fill%3D%22%23dfdfdf%22%20fill-opacity%3D%22.5%22%20d%3D%22M795.3%20207.8l-843.7-64.5L363.4%2067l485-99.1z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="161" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step1-v2-800x161.png" alt="Red-black tree deletion: Black sibling with black children and red parent" class="wp-image-22545" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step1-v2-800x161.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step1-v2-224x45.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step1-v2-336x68.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step1-v2-504x101.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step1-v2-672x135.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step1-v2-400x81.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step1-v2-600x121.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step1-v2-944x190.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step1-v2-1200x242.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step1-v2.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Case 3: Black sibling with black children and red parent</figcaption></figure></div>



<p>The deletion violates rule 5: In the rightmost path, we now have one black node less than in all others.</p>



<p>The sibling (the 18 in the example) is black and has two black children (the NIL leaves not shown). The parent (the 19) is red. In this case, we repair the tree as follows:</p>



<p>We recolor the sibling (the 18) red and the parent (the 19) black:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-lazyloaded="1" data-placeholder-resp="1600x358" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%221600%22%20height%3D%22358%22%20viewBox%3D%220%200%201600%20358%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23e4e4e4%22%20d%3D%22M0%200h1600v356H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22matrix(6.25%200%200%206.25%203.1%203.1)%22%20fill-opacity%3D%22.5%22%3E%3Cellipse%20fill%3D%22%23fff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-8.78656%20114.19153%20-19.31527%20-1.48623%20122.5%2015.6)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(19.09306%201.00062%20-4.94667%2094.3881%20124.2%2022.7)%22%2F%3E%3Cellipse%20fill%3D%22%23dcdcdc%22%20cx%3D%22213%22%20cy%3D%2228%22%20rx%3D%2273%22%20ry%3D%2273%22%2F%3E%3Cellipse%20fill%3D%22%23dcdcdc%22%20cx%3D%2248%22%20cy%3D%2214%22%20rx%3D%2256%22%20ry%3D%2295%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="1600" height="358" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step2.png" alt="Red-black tree deletion: Black sibling with black children and red parent: Recoloring parent and sibling" class="wp-image-22544" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step2.png 1600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step2-224x50.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step2-336x75.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step2-504x113.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step2-672x150.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step2-400x90.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step2-600x134.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step2-800x179.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step2-944x211.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-3-step2-1200x269.png 1200w" data-sizes="(max-width: 1600px) 100vw, 1600px"><figcaption>Recoloring parent and sibling</figcaption></figure></div>



<p>Thus we have a valid red-black tree again. The number of black nodes is the same on all paths (as required by rule 5). And since the sibling has only black children, coloring it red cannot violate rule 4 ("no red-red!").</p>



<h4><span id="Case_4_Sibling_Is_Black_and_Has_Two_Black_Children_Parent_Is_Black"><span id="Case_4_Sibling_Is_Black_and_Has_Two_Black_Children_Parent_Is_Black">Case 4: Sibling Is Black and Has Two Black Children, Parent Is Black</span></span></h4>



<p>In the following example, we delete the 18:</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x169" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22169%22%20viewBox%3D%220%200%20800%20169%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23e1e1e1%22%20d%3D%22M0%200h800v168H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22translate(1.6%201.6)%20scale(3.125)%22%20fill-opacity%3D%22.5%22%3E%3Cpath%20fill%3D%22%23fff%22%20d%3D%22M141-3.1l-1.1%2022-33-1.8%201.2-22z%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(178.7%2062%204.6)%20scale(16.70036%2011.12875)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(140.7%2062%2022.5)%20scale(18.13696%2015.69266)%22%2F%3E%3Cellipse%20fill%3D%22%23dfdfdf%22%20cx%3D%22204%22%20cy%3D%2253%22%20rx%3D%2278%22%20ry%3D%2278%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="169" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step1-800x169.png" alt="Red-black tree deletion: Black sibling with black children and a black parent" class="wp-image-22559" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step1-800x169.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step1-224x47.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step1-336x71.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step1-504x106.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step1-672x142.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step1-400x85.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step1-600x127.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step1-944x199.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step1-1200x254.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step1.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Case 4: Black sibling with black children and a black parent</figcaption></figure></div>



<p>This leads (just like in case 3) to a violation of rule 5: On the path to the deleted node, we now have one black node less than on all other paths.</p>



<p>In contrast to case 3, in this case, the parent node of the deleted node is black. We first color the sibling red:</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x179" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22179%22%20viewBox%3D%220%200%20800%20179%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23e1e1e1%22%20d%3D%22M0%200h800v178H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-47.91122%2017.5901%20-25.63765%20-69.83078%20390%201.6)%22%2F%3E%3Cpath%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20d%3D%22M427.8%2071.2l-87.6-23.5L363-36.8l87.5%2023.5z%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(52.97682%2072.01114%20-26.3522%2019.38667%20378.6%201.6)%22%2F%3E%3Cpath%20fill%3D%22%23dfdfdf%22%20fill-opacity%3D%22.5%22%20d%3D%22M102.3-43.9L-48.4%20183.3l896.8-2.9L502%20100.7z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="179" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step2-800x179.png" alt="Red-black tree deletion: Black sibling with black children and black parent: Recoloring the sibling" class="wp-image-22560" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step2-800x179.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step2-224x50.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step2-336x75.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step2-504x113.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step2-672x150.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step2-400x90.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step2-600x134.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step2-944x211.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step2-1200x269.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step2.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Step 1: Recoloring the sibling</figcaption></figure></div>



<p>That means that the black height in the subtree that starts at the parent node is again uniform (2). In the left subtree, however, it is one higher (3). Rule 5 is therefore still violated.</p>



<h4><span id="Case_4_-_Recursion"><span id="Case_4_-_Recursion">Case 4 ‒ Recursion</span></span></h4>



<p>We solve this problem by pretending that we deleted a black node between nodes 17 and 19 (which would have had the same effect). Accordingly, we call the repair function recursively on the parent node, i.e., the 19 (which would have been the moved-up node in this case).</p>



<p>The 19 has a black sibling (the 9) with two black children (3 and 12) and a red parent (17). Accordingly, we are now back to case 3.</p>



<p>We solve case 3 by coloring the parent black and the sibling red:</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x174" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22174%22%20viewBox%3D%220%200%20800%20174%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23e2e2e2%22%20d%3D%22M0%200h800v171H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22translate(1.6%201.6)%20scale(3.125)%22%20fill-opacity%3D%22.5%22%3E%3Cellipse%20fill%3D%22%23fff%22%20cx%3D%22126%22%20rx%3D%2225%22%20ry%3D%2223%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(87.6%2059.9%2069)%20scale(16.51037%2024.55525)%22%2F%3E%3Cpath%20fill%3D%22%23fff%22%20d%3D%22M149.7-2.4L137%2025.9l-34.8-15.5L115-17.9z%22%2F%3E%3Cpath%20fill%3D%22%23dedede%22%20d%3D%22M-8%2070l244-16L-9-16z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="174" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step3-v2-800x174.png" alt="Red-black tree deletion: Black sibling with black children and black parent: Recoloring parent and sibling" class="wp-image-22562" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step3-v2-800x174.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step3-v2-224x49.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step3-v2-336x73.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step3-v2-504x110.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step3-v2-672x146.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step3-v2-400x87.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step3-v2-600x131.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step3-v2-944x205.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step3-v2-1200x261.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-4-step3-v2.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>(Step 2: Recoloring parent and sibling)</figcaption></figure></div>



<p>The black height is now two on all paths, so our red-black tree is valid again.</p>



<h4><span id="Case_5_Sibling_is_black_and_has_at_least_one_red_child_outer_nephew_is_black"><span id="Case_5_Sibling_is_black_and_has_at_least_one_red_child_outer_nephew_is_black">Case 5: Sibling is black and has at least one red child, "outer nephew" is black </span></span></h4>



<p>In this example, we delete the 18:</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x228" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22228%22%20viewBox%3D%220%200%20800%20228%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23ededed%22%20d%3D%22M0%200h800v225H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22translate(1.6%201.6)%20scale(3.125)%22%20fill-opacity%3D%22.5%22%3E%3Cellipse%20fill%3D%22%23fff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(140.5%2067.6%2059.5)%20scale(37.35933%2087.43452)%22%2F%3E%3Cellipse%20fill%3D%22%23d5d5d5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(106.80908%2079.07066%20-15.66969%2021.1667%20239.2%2043.9)%22%2F%3E%3Cellipse%20fill%3D%22%23d4d4d4%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(54.4%2013.8%2065.3)%20scale(69.85448%2029.30981)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20cx%3D%228%22%20cy%3D%2263%22%20rx%3D%2245%22%20ry%3D%2236%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="228" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step1-800x228.png" alt="Red-black tree deletion: Black sibling with at least one red child and a black &quot;outer nephew&quot;" class="wp-image-22580" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step1-800x228.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step1-224x64.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step1-336x96.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step1-504x144.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step1-672x192.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step1-400x114.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step1-600x171.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step1-944x269.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step1-1200x342.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step1.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Case 5: Black sibling with at least one red child and a black "outer nephew"</figcaption></figure></div>



<p>As a result, we again violated rule 5 since the subtree starting at the sibling now has a black height greater by one.</p>



<p>We examine the "outer nephew" of the deleted node. "Outer nephew" means the child of the sibling that is opposite the deleted node. In the example, this is the right (and by definition black) NIL leaf under the 75.</p>



<p>In the following graphic, you can see that parent, sibling and nephew together form a line (in the example: 19, 75, and its right NIL child).</p>



<p>We start the repair by coloring the inner nephew (the 24 in the example) black and the sibling (the 75) red:</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x229" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22229%22%20viewBox%3D%220%200%20800%20229%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23ececec%22%20d%3D%22M0%200h800v228H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22translate(1.6%201.6)%20scale(3.125)%22%20fill-opacity%3D%22.5%22%3E%3Cellipse%20fill%3D%22%23fff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(24.21138%20-17.42159%2079.86396%20110.98972%20158.2%2060.8)%22%2F%3E%3Cellipse%20fill%3D%22%23d6d6d6%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-20.38483%2018.78454%20-79.11235%20-85.85209%20216%2035.2)%22%2F%3E%3Cpath%20fill%3D%22%23d5d5d5%22%20d%3D%22M85%2084.3L3%205.1l36-37.4%2082%2079.2z%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20cx%3D%2216%22%20cy%3D%2261%22%20rx%3D%2233%22%20ry%3D%2230%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="229" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step2-800x229.png" alt="Red-black tree deletion: Black sibling with at least one red child and black &quot;outer nephew&quot;: Recoloring sibling and inner nephew" class="wp-image-22581" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step2-800x229.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step2-224x64.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step2-336x96.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step2-504x144.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step2-672x192.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step2-400x115.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step2-600x172.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step2-944x270.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step2-1200x344.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step2.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Step 1: Recoloring sibling and inner nephew</figcaption></figure></div>



<p>Then we perform a rotation at the sibling node <em>in the opposite direction of the deleted node</em>. In the example, we've deleted the parent's&nbsp;<em>left</em>&nbsp;child, so we perform a&nbsp;<em>right</em>&nbsp;rotation at the sibling (the 75):</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x229" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22229%22%20viewBox%3D%220%200%20800%20229%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23ededed%22%20d%3D%22M0%200h800v228H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-42.8%20558.1%20-573.2)%20scale(115.64323%20388.55311)%22%2F%3E%3Cellipse%20fill%3D%22%23d4d4d4%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-51.3%20184.3%20-144.2)%20scale(91.3746%20198.48502)%22%2F%3E%3Cellipse%20fill%3D%22%23d5d5d5%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-143.8%20385%20-59)%20scale(560.68908%2068.54973)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(94.64074%2048.85294%20-37.8708%2073.3655%2037.8%20185.2)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="229" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step3-800x229.png" alt="Red-black tree deletion: Black sibling with at least one red child and black &quot;outer nephew&quot;: Rotation around sibling" class="wp-image-22582" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step3-800x229.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step3-224x64.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step3-336x96.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step3-504x144.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step3-672x192.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step3-400x115.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step3-600x172.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step3-944x270.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step3-1200x344.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step3.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Step 2: Rotation around sibling</figcaption></figure></div>



<p>We are doing some recoloring again:</p>



<ul><li>We recolor the sibling in the color of its parent (in the example, the 24 red).</li><li>Then we recolor the parent (the 19) and the outer nephew of the deleted node, i.e., the right child of the new sibling (the 75 in the example) black:</li></ul>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x229" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22229%22%20viewBox%3D%220%200%20800%20229%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23eee%22%20d%3D%22M0%200h800v228H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22translate(1.6%201.6)%20scale(3.125)%22%20fill-opacity%3D%22.5%22%3E%3Cellipse%20fill%3D%22%23fff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-21.2456%2025.11589%20-71.63431%20-60.59566%20162.7%2055.3)%22%2F%3E%3Cellipse%20fill%3D%22%23d4d4d4%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-14.1413%2019.54919%20-53.7125%20-38.85403%2057.6%2021.6)%22%2F%3E%3Cpath%20fill%3D%22%23d3d3d3%22%20d%3D%22M274.6%20103.3L135-13.7l28.3-33.6L303%2069.7z%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20cx%3D%2221%22%20cy%3D%2270%22%20rx%3D%2238%22%20ry%3D%2238%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="229" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step4-800x229.png" alt="Red-black tree deletion: Black sibling with at least one red child and black &quot;outer nephew&quot;: Recoloring parent, sibling, and nephew  " class="wp-image-22583" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step4-800x229.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step4-224x64.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step4-336x96.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step4-504x144.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step4-672x192.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step4-400x115.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step4-600x172.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step4-944x270.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step4-1200x344.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step4.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Step 3: Recoloring parent, sibling, and nephew</figcaption></figure></div>



<p>Finally, we perform a rotation on the parent node <em>in the direction of the deleted node</em>. In the example, the deleted node was a <em>left</em> child, so we perform a <em>left</em> rotation accordingly (at 19 in the example):</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x228" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22228%22%20viewBox%3D%220%200%20800%20228%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23eee%22%20d%3D%22M0%200h800v225H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(295.34992%20242.60316%20-58.2035%2070.8581%20581.8%20223.9)%22%2F%3E%3Cellipse%20fill%3D%22%23d3d3d3%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(308.52821%2057.63414%20-15.51816%2083.07211%20798.4%2089.1)%22%2F%3E%3Cellipse%20fill%3D%22%23d4d4d4%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-139.9%20139.2%207.8)%20scale(174.75963%2075.13854)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-162.4%2061.8%2081.2)%20scale(126.1438%2075.27093)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="228" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step5-800x228.png" alt="Red-black tree deletion: Black sibling with at least one red child and black &quot;outer nephew&quot;: Rotation around the 
parent" class="wp-image-22584" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step5-800x228.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step5-224x64.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step5-336x96.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step5-504x144.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step5-672x192.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step5-400x114.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step5-600x171.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step5-944x269.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step5-1200x342.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-5-step5.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Step 4: Rotation around the parent</figcaption></figure></div>



<p>This last step restores compliance with all red-black rules. There are no two consecutive red nodes, and the number of black nodes is uniformly two on all paths. We've thus completed the repair of the tree.</p>



<h4><span id="Case_6_Sibling_is_black_and_has_at_least_one_red_child_outer_nephew_is_red"><span id="Case_6_Sibling_is_black_and_has_at_least_one_red_child_outer_nephew_is_red">Case 6: Sibling is black and has at least one red child, "outer nephew" is red</span></span></h4>



<p>In the last example, which is very similar to case 5, we also delete the 18:</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x229" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22229%22%20viewBox%3D%220%200%20800%20229%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23ebebeb%22%20d%3D%22M0%200h800v228H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22translate(1.6%201.6)%20scale(3.125)%22%20fill-opacity%3D%22.5%22%3E%3Cellipse%20fill%3D%22%23fff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-49.4297%20-60.00593%2023.32025%20-19.20998%20149.2%2046.5)%22%2F%3E%3Cellipse%20fill%3D%22%23d6d6d6%22%20cx%3D%2277%22%20cy%3D%2249%22%20rx%3D%2237%22%20ry%3D%2237%22%2F%3E%3Cellipse%20fill%3D%22%23d6d6d6%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-73.91031%20-71.57178%2017.93749%20-18.52358%20216.7%2035)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-158.2%209.5%2029.1)%20scale(38.568%2028.55034)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="229" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step1-800x229.png" alt="Red-black tree deletion: Black sibling with at least one red child and a red &quot;outer nephew&quot;" class="wp-image-22569" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step1-800x229.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step1-224x64.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step1-336x96.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step1-504x144.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step1-672x192.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step1-400x115.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step1-600x172.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step1-944x270.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step1-1200x344.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step1.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Case 6: Black sibling with at least one red child and a red "outer nephew"</figcaption></figure></div>



<p>As a result, as in case 5, we violated rule 5 because the path to the deleted node now contains one less black node.</p>



<p>In case 6, unlike case 5, the outer nephew (81 in the example) is red and not black.</p>



<p>We first recolor the sibling in the parent's color (in the example, the 75 red). Then we recolor the parent (the 19 in the example) and the outer nephew (the 81) black:</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x228" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22228%22%20viewBox%3D%220%200%20800%20228%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23ebebeb%22%20d%3D%22M0%200h800v225H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(339.54052%20476.81963%20-73.28316%2052.18452%20511.5%20210.2)%22%2F%3E%3Cellipse%20fill%3D%22%23d5d5d5%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(241.22222%20125.67442%20-34.67803%2066.56177%20135.7%2047.8)%22%2F%3E%3Cellipse%20fill%3D%22%23d7d7d7%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(70.17127%20-63.90972%20197.42924%20216.77236%20711.4%20142.2)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-155.4%2039.5%2082.2)%20scale(104.1483%2071.68086)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="228" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step2-800x228.png" alt="Red-black tree deletion: Black sibling with at least one red child and red &quot;outer nephew&quot;: Recoloring parent, sibling, and nephew" class="wp-image-22570" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step2-800x228.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step2-224x64.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step2-336x96.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step2-504x144.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step2-672x192.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step2-400x114.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step2-600x171.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step2-944x269.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step2-1200x342.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step2.png 1600w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Step 1: Recoloring parent, sibling, and nephew</figcaption></figure></div>



<p>Second, we perform a rotation at the parent node <em>in the direction of the deleted node</em>. In the example, we've deleted a&nbsp;<em>left</em>&nbsp;child; accordingly, we perform a <em>left</em> rotation around the 19:</p>



<div class="wp-block-image"><figure class="aligncenter size-full_800"><img data-lazyloaded="1" data-placeholder-resp="800x239" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22800%22%20height%3D%22239%22%20viewBox%3D%220%200%20800%20239%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23eaeaea%22%20d%3D%22M0%200h800v237H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22translate(1.6%201.6)%20scale(3.125)%22%20fill-opacity%3D%22.5%22%3E%3Cellipse%20fill%3D%22%23fff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(102.60556%20122.97212%20-19.8309%2016.54653%20159.1%2055.1)%22%2F%3E%3Cellipse%20fill%3D%22%23fff%22%20cx%3D%2210%22%20cy%3D%2268%22%20rx%3D%2236%22%20ry%3D%2236%22%2F%3E%3Cellipse%20fill%3D%22%23d6d6d6%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(11.92809%20-22.47416%2059.19024%2031.41502%2068.5%2030.2)%22%2F%3E%3Cellipse%20fill%3D%22%23d7d7d7%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-138.3%20120.3%20-30.4)%20scale(139.83884%2041.52096)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" loading="lazy" width="800" height="239" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step3-800x239.png" alt="Red-black tree deletion: Black sibling with at least one red child and red &quot;outer nephew&quot;: Rotation around the 
parent" class="wp-image-22571" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step3-800x239.png 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step3-224x67.png 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step3-336x100.png 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step3-504x151.png 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step3-672x201.png 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step3-400x120.png 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step3-600x179.png 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step3-944x282.png 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step3-1200x359.png 1200w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-delete-node-case-6-step3.png 1526w" data-sizes="(max-width: 800px) 100vw, 800px"><figcaption>Step 2: Rotation around the parent</figcaption></figure></div>



<p>This rotation restores the red-black rules. No two red nodes follow each other, and the number of black nodes is the same on all paths (namely 2).</p>



<p>The rules in this last case are similar to the final two steps of case 5. In the source code, you will see that for case 5, only its first two steps are implemented, and the program then goes to case 6 to execute the last two steps.</p>



<p>With this, we have studied all six cases. Let's move on to the implementation of the repair function in Java.</p>



<h4><span id="Implementation_of_the_Post-Deletion_Repair_Method"><span id="Implementation_of_the_Post-Deletion_Repair_Method">Implementation of the Post-Deletion Repair Method</span></span></h4>



<p>You can find the <code>fixRedBlackPropertiesAfterDelete()</code> method <a rel="noopener" href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/RedBlackTree.java#L252" target="_blank">in the source code starting at line 252</a>. I have marked cases 1 to 6 with comments.</p>


<pre class="wp-block-code" aria-describedby="shcb-language-14" data-shcb-language-name="Java" data-shcb-language-slug="java"><div><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">fixRedBlackPropertiesAfterDelete</span><span class="hljs-params">(Node node)</span> </span>{
  <span class="hljs-comment">// Case 1: Examined node is root, end of recursion</span>
  <span class="hljs-keyword">if</span> (node == root) {
    <span class="hljs-comment">// Uncomment the following line if you want to enforce black roots (rule 2):</span>
    <span class="hljs-comment">// node.color = BLACK;</span>
    <span class="hljs-keyword">return</span>;
  }

  Node sibling = getSibling(node);

  <span class="hljs-comment">// Case 2: Red sibling</span>
  <span class="hljs-keyword">if</span> (sibling.color == RED) {
    handleRedSibling(node, sibling);
    sibling = getSibling(node); <span class="hljs-comment">// Get new sibling for fall-through to cases 3-6</span>
  }

  <span class="hljs-comment">// Cases 3+4: Black sibling with two black children</span>
  <span class="hljs-keyword">if</span> (isBlack(sibling.left) &amp;&amp; isBlack(sibling.right)) {
    sibling.color = RED;

    <span class="hljs-comment">// Case 3: Black sibling with two black children + red parent</span>
    <span class="hljs-keyword">if</span> (node.parent.color == RED) {
      node.parent.color = BLACK;
    }

    <span class="hljs-comment">// Case 4: Black sibling with two black children + black parent</span>
    <span class="hljs-keyword">else</span> {
      fixRedBlackPropertiesAfterDelete(node.parent);
    }
  }

  <span class="hljs-comment">// Case 5+6: Black sibling with at least one red child</span>
  <span class="hljs-keyword">else</span> {
    handleBlackSiblingWithAtLeastOneRedChild(node, sibling);
  }
}</code></div><small class="shcb-language" id="shcb-language-14"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Java</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">java</span><span class="shcb-language__paren">)</span></small></pre>


<p>You will find the helper methods <code>getSibling()</code> and <code>isBlack()</code> <a href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/RedBlackTree.java#L334" target="_blank" rel="noopener">starting at line 334</a>:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-15" data-shcb-language-name="Java" data-shcb-language-slug="java"><div><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">private</span> Node <span class="hljs-title">getSibling</span><span class="hljs-params">(Node node)</span> </span>{
  Node parent = node.parent;
  <span class="hljs-keyword">if</span> (node == parent.left) {
    <span class="hljs-keyword">return</span> parent.right;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (node == parent.right) {
    <span class="hljs-keyword">return</span> parent.left;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalStateException(<span class="hljs-string">"Parent is not a child of its grandparent"</span>);
  }
}

<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isBlack</span><span class="hljs-params">(Node node)</span> </span>{
  <span class="hljs-keyword">return</span> node == <span class="hljs-keyword">null</span> || node.color == BLACK;
}</code></div><small class="shcb-language" id="shcb-language-15"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Java</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">java</span><span class="shcb-language__paren">)</span></small></pre>


<p>Handling a red sibling (case 2) <a rel="noopener" href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/RedBlackTree.java#L289" target="_blank">starts at line 289</a>:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-16" data-shcb-language-name="Java" data-shcb-language-slug="java"><div><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleRedSibling</span><span class="hljs-params">(Node node, Node sibling)</span> </span>{
  <span class="hljs-comment">// Recolor...</span>
  sibling.color = BLACK;
  node.parent.color = RED;

  <span class="hljs-comment">// ... and rotate</span>
  <span class="hljs-keyword">if</span> (node == node.parent.left) {
    rotateLeft(node.parent);
  } <span class="hljs-keyword">else</span> {
    rotateRight(node.parent);
  }
}</code></div><small class="shcb-language" id="shcb-language-16"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Java</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">java</span><span class="shcb-language__paren">)</span></small></pre>


<p>You can find the implementation for a black sibling knot with at least one red child (cases 5 and 6) <a href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/RedBlackTree.java#L302" target="_blank" rel="noopener">starting at line 302</a>:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-17" data-shcb-language-name="Java" data-shcb-language-slug="java"><div><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleBlackSiblingWithAtLeastOneRedChild</span><span class="hljs-params">(Node node, Node sibling)</span> </span>{
  <span class="hljs-keyword">boolean</span> nodeIsLeftChild = node == node.parent.left;

  <span class="hljs-comment">// Case 5: Black sibling with at least one red child + "outer nephew" is black</span>
  <span class="hljs-comment">// --&gt; Recolor sibling and its child, and rotate around sibling</span>
  <span class="hljs-keyword">if</span> (nodeIsLeftChild &amp;&amp; isBlack(sibling.right)) {
    sibling.left.color = BLACK;
    sibling.color = RED;
    rotateRight(sibling);
    sibling = node.parent.right;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!nodeIsLeftChild &amp;&amp; isBlack(sibling.left)) {
    sibling.right.color = BLACK;
    sibling.color = RED;
    rotateLeft(sibling);
    sibling = node.parent.left;
  }

  <span class="hljs-comment">// Fall-through to case 6...</span>

  <span class="hljs-comment">// Case 6: Black sibling with at least one red child + "outer nephew" is red</span>
  <span class="hljs-comment">// --&gt; Recolor sibling + parent + sibling's child, and rotate around parent</span>
  sibling.color = node.parent.color;
  node.parent.color = BLACK;
  <span class="hljs-keyword">if</span> (nodeIsLeftChild) {
    sibling.right.color = BLACK;
    rotateLeft(node.parent);
  } <span class="hljs-keyword">else</span> {
    sibling.left.color = BLACK;
    rotateRight(node.parent);
  }
}</code></div><small class="shcb-language" id="shcb-language-17"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Java</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">java</span><span class="shcb-language__paren">)</span></small></pre>


<p>Just as for inserting, you will find numerous alternative approaches for deleting in the literature. I have tried to structure the code so that you can follow the code flow as well as possible.</p>



<h3><span id="Traversing_the_Red-Black_Tree"><span id="Traversing_the_Red-Black_Tree">Traversing the Red-Black Tree</span></span></h3>



<p>Like any binary tree, we can traverse the red-black tree in pre-order, post-order, in-order, reverse-in-order, and level-order. In the <a href="/algorithms/binary-tree-java/#Binary_Tree_Traversal">"Binary Tree Traversal"</a> section of the introductory article on binary trees, I have described traversal in detail.</p>



<p>In that section, you will also find the corresponding Java source code, implemented in the classes <code><a rel="noopener" href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/DepthFirstTraversal.java" target="_blank">DepthFirstTraversal</a></code>,&nbsp;<code><a rel="noopener" href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/DepthFirstTraversalIterative.java" target="_blank">DepthFirstTraversalIterative</a></code>, and&nbsp;<code><a rel="noopener" href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/DepthFirstTraversalRecursive.java" target="_blank">DepthFirstTraversalRecursive</a></code>.</p>



<p>The traversal methods work on the <a rel="noopener" href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/BinaryTree.java" target="_blank"><code>BinaryTree</code></a> interface. Since <code><a rel="noopener" href="https://github.com/SvenWoltmann/binary-tree/blob/main/src/main/java/eu/happycoders/binarytree/RedBlackTree.java" target="_blank">RedBlackTree</a></code> also implements this interface, we can easily apply the traversal methods to it as well.</p>



<h2><span id="Red-Black_Tree_Time_Complexity"><span id="Red-Black_Tree_Time_Complexity">Red-Black Tree Time Complexity</span></span></h2>



<p>For an introduction to the topic of time complexity and O-notation, <a href="/algorithms/big-o-notation-time-complexity/">see this article</a>.</p>


<script data-uid="92fc3cdb4a" src="https://happycoders.ck.page/92fc3cdb4a/index.js" defer data-deferred="1"></script>



<p>We can determine the cost of searching, inserting, and deleting a node in the binary tree as follows:</p>



<h3><span id="Search_Time"><span id="Search_Time">Search Time</span></span></h3>



<p>We follow a path from the root to the searched node (or to a NIL leaf). At each level, we perform a comparison. The effort for the comparison is constant.</p>



<p>The search cost is thus proportional to the tree height.</p>



<p>We denote by <em>n</em> the number of tree nodes. In the <a href="#Height_of_a_Red-Black_Tree">"Height of a Red-Black Tree"</a> section, we have recognized that the longest path is at most twice as long as the shortest path. It follows that the height of the tree is bounded by <em>O(log n)</em>.</p>



<p>A formal proof is beyond the scope of this article. You can read the proof on <a href="https://en.wikipedia.org/wiki/Red%E2%80%93black_tree#Proof_of_bounds" target="_blank" rel="noopener">Wikipedia</a>.</p>



<p>Thus, the time complexity for finding a node in a red-black tree is: <em>O(log n)</em></p>



<h3><span id="Insertion_Time"><span id="Insertion_Time">Insertion Time</span></span></h3>



<p>When inserting, we first perform a search. We have just determined the search cost as <em>O(log n)</em>.</p>



<p>Next, we insert a node. The cost of this is constant regardless of the tree size, so <em>O(1)</em>.</p>



<p>Then we check the red-black rules and restore them if necessary. We do this starting at the inserted node and ascending to the root. At each level, we perform one or more of the following operations:</p>



<ul><li>Checking the color of the parent node</li><li>Determination of the uncle node and checking its color</li><li>Recoloring one up to three nodes</li><li>Performing one or two rotations</li></ul>



<p>Each of these operations has constant time, <em>O(1)</em>, in itself. The total time for checking and repairing the tree is therefore also proportional to its height.</p>



<p>So the time complexity for inserting into a red-black tree is also: <em>O(log n)</em></p>



<h3><span id="Deletion_Time"><span id="Deletion_Time">Deletion Time</span></span></h3>



<p>Just as with insertion, we first search for the node to be deleted in time <em>O(log n)</em>.</p>



<p>Also, the deletion cost is independent of the tree size, so it is constant <em>O(1)</em>.</p>



<p>For checking the rules and repairing the tree, one or more of the following operations occur – at most once per level:</p>



<ul><li>Checking the color of the deleted node</li><li>Determining the sibling and examining its color</li><li>Checking the colors of the sibling's children</li><li>Recoloring the parent node</li><li>Recoloring the sibling node and one of its children</li><li>Performing one or two rotations</li></ul>



<p>These operations also all have a constant complexity in themselves. Thus, the total effort for checking and restoring the rules after deleting a node is also proportional to the tree height.</p>



<p>So the time complexity for deleting from a red-black tree is also: <em>O(log n)</em></p>



<h2><span id="Red-Black_Tree_Compared_With_Other_Data_Structures"><span id="Red-Black_Tree_Compared_With_Other_Data_Structures">Red-Black Tree Compared With Other Data Structures</span></span></h2>



<p>The following sections describe the differences and the advantages and disadvantages of the red-black tree compared to alternative data structures.</p>



<h3><span id="Red-Black_Tree_vs_AVL_Tree"><span id="Red-Black_Tree_vs_AVL_Tree">Red-Black Tree vs. AVL Tree</span></span></h3>



<p>The red-black tree, as well as the <a href="/algorithms/avl-tree-java/">AVL tree</a>, are self-balancing binary search trees.</p>



<p>In the red-black tree, the longest path to the root is at most twice as long as the shortest path to the root. On the other hand, in the AVL tree, the depth of no two subtrees differs by more than 1.</p>



<p>In the red-black tree, balance is maintained by the node colors, a set of rules, and by rotating and recoloring nodes. In the AVL tree, the heights of the subtrees are compared, and rotations are performed when necessary.</p>



<p>These differences in the characteristics of the two types of trees lead to the following differences in performance and memory requirements:</p>



<ul><li>Due to the more even balancing of the AVL tree, search in an AVL tree is usually faster. In terms of magnitude, however, both are in the range <em>O(log n)</em>.</li><li>For insertion and deletion, the time complexity in both trees is <em>O(log n)</em>. In a direct comparison, however, the red-black tree is faster because it rebalances less frequently.</li><li>Both trees require additional memory: the AVL tree one byte per node for the height of the subtree starting at a node; the red-black tree one bit per node for the color information. This rarely makes a difference in practice since a single bit usually occupies at least one byte.</li></ul>



<p>If you expect many insert/delete operations, then you should use a red-black tree. If, on the other hand, you expect more search operations, then you should choose the AVL tree.</p>



<h3><span id="Red-Black_Tree_vs_Binary_Search_Tree"><span id="Red-Black_Tree_vs_Binary_Search_Tree">Red-Black Tree vs. Binary Search Tree</span></span></h3>



<p>The red-black tree is a concrete implementation of a self-balancing binary search tree. So every red-black tree is also a binary search tree.</p>



<p>There are also other types of binary search trees, such as the AVL tree mentioned above – or trivial non-balanced implementations. Thus, not every binary search tree is also a red-black tree.</p>



<h2><span id="Summary"><span id="Summary">Summary</span></span></h2>



<p>This tutorial taught you what a red-black tree is, which rules govern it and how these rules are evaluated and restored if necessary after inserting and deleting nodes. I also introduced you to a Java implementation that is as easy to understand as possible.</p>



<p>The JDK uses red-black trees in <a rel="noopener" href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/TreeMap.html" target="_blank">TreeMap</a> (here is the <a rel="noopener" href="https://github.com/openjdk/jdk/blob/master/src/java.base/share/classes/java/util/TreeMap.java" target="_blank">source code</a> on GitHub) and in bucket collisions in <a rel="noopener" href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/HashMap.html" target="_blank">HashMap</a> (here is the <a rel="noopener" href="https://github.com/openjdk/jdk/blob/master/src/java.base/share/classes/java/util/HashMap.java#L1932" target="_blank">source code</a>).</p>



<p>With this, I conclude the tutorial series on binary trees.</p>



<p>If I could help you better understand <a href="/algorithms/binary-tree-java/">binary trees in general</a>, <a href="/algorithms/binary-search-tree-java/">binary search trees</a>, <a href="/algorithms/avl-tree-java/">AVL trees</a>, and – in this article – red-black trees, I'm happy about a comment. Also, feel free to share the article using one of the share buttons at the end.</p>



<p>Do you want to be informed when the next article is published on HappyCoders.eu? Then <a href="#" data-formkit-toggle="bebaa18901">click here</a> to sign up for the HappyCoders newsletter.</p>
<script data-uid="f24402b59d" src="https://happycoders.ck.page/f24402b59d/index.js" defer data-deferred="1"></script><script data-uid="7802e02f97" src="https://happycoders.ck.page/7802e02f97/index.js" defer data-deferred="1"></script><script data-uid="bebaa18901" src="https://happycoders.ck.page/bebaa18901/index.js" defer data-deferred="1"></script></span></div></div></section><section id="section-111-18731" class=" ct-section"><div class="ct-section-inner-wrap"><div id="code_block-75-18194" class="ct-code-block hc_s_bottom"><a class="hc_s_link hc_s_fb" href="javascript:void(0)" onclick="openSharerFB(); return false;">
  <span class="hc_s_icon">
    <svg viewbox="0 0 264 512">
      <path d="M76.7 512V283H0v-91h76.7v-71.7C76.7 42.4 124.3 0 193.8 0c33.3 0 61.9 2.5 70.2 3.6V85h-48.2c-37.8 0-45.1 18-45.1 44.3V192H256l-11.7 91h-73.6v229"></path>
    </svg>
  </span>
  <span class="hc_s_cta">Share</span>
</a>

<a class="hc_s_link hc_s_tw" href="javascript:void(0)" onclick="openSharerTW(); return false;">
  <span class="hc_s_icon">
    <svg viewbox="0 0 512 512">
      <path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path>
    </svg>
  </span>
  <span class="hc_s_cta">Tweet</span>
</a>

<a class="hc_s_link hc_s_li" href="javascript:void(0)" onclick="openSharerLI(); return false;">
  <span class="hc_s_icon">
    <svg viewbox="0 0 448 512">
      <path d="M100.3 480H7.4V180.9h92.9V480zM53.8 140.1C24.1 140.1 0 115.5 0 85.8 0 56.1 24.1 32 53.8 32c29.7 0 53.8 24.1 53.8 53.8 0 29.7-24.1 54.3-53.8 54.3zM448 480h-92.7V334.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V480h-92.8V180.9h89.1v40.8h1.3c12.4-23.5 42.7-48.3 87.9-48.3 94 0 111.3 61.9 111.3 142.3V480z"></path>
    </svg>
  </span>
  <span class="hc_s_cta">Share</span>
</a>


<a class="hc_s_link hc_s_xi" href="javascript:void(0)" onclick="openSharerXI(); return false;">
  <span class="hc_s_icon">
    <svg viewbox="0 0 384 512">
      <path d="M162.7 210c-1.8 3.3-25.2 44.4-70.1 123.5-4.9 8.3-10.8 12.5-17.7 12.5H9.8c-7.7 0-12.1-7.5-8.5-14.4l69-121.3c.2 0 .2-.1 0-.3l-43.9-75.6c-4.3-7.8.3-14.1 8.5-14.1H100c7.3 0 13.3 4.1 18 12.2l44.7 77.5zM382.6 46.1l-144 253v.3L330.2 466c3.9 7.1.2 14.1-8.5 14.1h-65.2c-7.6 0-13.6-4-18-12.2l-92.4-168.5c3.3-5.8 51.5-90.8 144.8-255.2 4.6-8.1 10.4-12.2 17.5-12.2h65.7c8 0 12.3 6.7 8.5 14.1z"></path>
    </svg>
  </span>
  <span class="hc_s_cta">Share</span>
</a>
</div></div></section><section id="section-34-18731" class=" ct-section"><div class="ct-section-inner-wrap"><div id="new_columns-82-18731" class="ct-new-columns"><div id="div_block-84-18731" class="ct-div-block"><div id="code_block-16-18876" class="ct-code-block "><img data-lazyloaded="1" data-placeholder-resp="224x269" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22224%22%20height%3D%22269%22%20viewBox%3D%220%200%20224%20269%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%2366717c%22%20d%3D%22M0%200h223v269H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23004a8a%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-201.92183%2013.41163%20-2.5427%20-38.28211%20101.6%20247)%22%2F%3E%3Cellipse%20fill%3D%22%23e4b3b5%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-40.07522%20-5.37918%209.80831%20-73.0725%2080.7%20125.7)%22%2F%3E%3Cellipse%20fill%3D%22%230d95c7%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-17.54894%20-34.21166%2055.55079%20-28.49489%2031%20236.9)%22%2F%3E%3Cellipse%20fill%3D%22%23794a4b%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(8.14353%20-109.20558%2036.20862%202.7001%20141.7%20115.4)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" data-src="https://www.happycoders.eu/wp-content/uploads/2021/01/sven_woltmann_600mq-224x269.jpg" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/01/sven_woltmann_600mq-224x269.jpg 224w, https://www.happycoders.eu/wp-content/uploads/2021/01/sven_woltmann_600mq-336x403.jpg 336w, https://www.happycoders.eu/wp-content/uploads/2021/01/sven_woltmann_600mq-504x605.jpg 504w, https://www.happycoders.eu/wp-content/uploads/2021/01/sven_woltmann_600mq-400x480.jpg 400w, https://www.happycoders.eu/wp-content/uploads/2021/01/sven_woltmann_600mq.jpg 600w" data-sizes="(max-width: 224px) 100vw, 224px" width="224" height="269" alt="Sven Woltmann"></div><div id="code_block-22-18876" class="ct-code-block hc_image_100pc"><img data-lazyloaded="1" data-placeholder-resp="600x375" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22600%22%20height%3D%22375%22%20viewBox%3D%220%200%20600%20375%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23887e81%22%20d%3D%22M0%200h600v375H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22translate(1.2%201.2)%20scale(2.34375)%22%20fill-opacity%3D%22.5%22%3E%3Cellipse%20fill%3D%22%23ceb8c0%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(-88%2072.4%20-21)%20scale(111.65006%2034.99704)%22%2F%3E%3Cellipse%20fill%3D%22%23574149%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(92.5%2026.3%20140.2)%20scale(255%2035.18699)%22%2F%3E%3Cellipse%20fill%3D%22%23c54e76%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-27.59051%20-1.70372%204.09057%20-66.24377%20136.3%2040.7)%22%2F%3E%3Cellipse%20fill%3D%22%238d9895%22%20cx%3D%22219%22%20cy%3D%2291%22%20rx%3D%2240%22%20ry%3D%2240%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" data-src="https://www.happycoders.eu/wp-content/uploads/2021/01/sven_woltmann_flat.jpg" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/01/sven_woltmann_flat.jpg 600w, https://www.happycoders.eu/wp-content/uploads/2021/01/sven_woltmann_flat-224x140.jpg 224w, https://www.happycoders.eu/wp-content/uploads/2021/01/sven_woltmann_flat-336x210.jpg 336w, https://www.happycoders.eu/wp-content/uploads/2021/01/sven_woltmann_flat-504x315.jpg 504w, https://www.happycoders.eu/wp-content/uploads/2021/01/sven_woltmann_flat-400x250.jpg 400w" data-sizes="(max-width: 600px) 100vw, 600px" width="600" height="375" alt="Sven Woltmann"></div></div><div id="div_block-85-18731" class="ct-div-block"><div id="div_block-96-18731" class="ct-div-block"><div id="div_block-104-18731" class="ct-div-block"><div id="text_block-105-18731" class="ct-text-block">About the author</div></div></div><div id="div_block-97-18731" class="ct-div-block"><div id="text_block-101-18731" class="ct-text-block"><span id="span-102-18731" class="ct-span">I'm a freelance software developer with more than two decades of experience in scalable Java enterprise applications. My focus is on optimizing complex algorithms and on advanced topics such as concurrency, the Java memory model, and garbage collection.

Here on HappyCoders.eu, I want to help you become a better Java programmer. Read more about me <a href="/about-sven-woltmann/">here</a>.</span></div></div><div id="div_block-100-18731" class="ct-div-block"><div id="div_block-108-18731" class="ct-div-block"><div id="code_block-109-18731" class="ct-code-block hc_follow_autor"><a href="https://twitter.com/svenwoltmann" target="_blank" rel="noopener" title="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewbox="-6 -6 36 36" style="width:36px"><circle cx="12" cy="12" r="18" fill="#999999"></circle><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z" fill="white"></path></svg></a><a href="https://www.linkedin.com/in/sven-woltmann/" target="_blank" rel="noopener" title="LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" viewbox="-8 -6 40 40" style="width:36px"><circle cx="12" cy="14" r="20" fill="#999999"></circle><path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z" fill="white"></path></svg></a><a href="https://www.xing.com/profile/Sven_Woltmann" target="_blank" rel="noopener" title="Xing"><svg xmlns="http://www.w3.org/2000/svg" viewbox="-6 -6 36 36" style="width:36px"><circle cx="12" cy="12" r="18" fill="#999999"></circle><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z" fill="white"></path></svg></a><a href="https://www.youtube.com/c/happycoders" target="_blank" rel="noopener" title="YouTube"><svg xmlns="http://www.w3.org/2000/svg" viewbox="-4 -4 32 32" style="width:36px"><circle cx="12" cy="12" r="16" fill="#999999"></circle><path d="M23.495 6.205a3.007 3.007 0 0 0-2.088-2.088c-1.87-.501-9.396-.501-9.396-.501s-7.507-.01-9.396.501A3.007 3.007 0 0 0 .527 6.205a31.247 31.247 0 0 0-.522 5.805 31.247 31.247 0 0 0 .522 5.783 3.007 3.007 0 0 0 2.088 2.088c1.868.502 9.396.502 9.396.502s7.506 0 9.396-.502a3.007 3.007 0 0 0 2.088-2.088 31.247 31.247 0 0 0 .5-5.783 31.247 31.247 0 0 0-.5-5.805zM9.609 15.601V8.408l6.264 3.602z" fill="white"></path></svg></a></div></div></div></div></div></div></section><section id="section-38-18731" class=" ct-section"><div class="ct-section-inner-wrap">
                <div id="_comment_form-39-18731" class="oxy-comment-form">
                	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title"><span id="Leave_a_Reply_Cancel_reply">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/algorithms/red-black-tree-java/#respond" style="display:none;">Cancel reply</a></small></span></h3><form action="https://www.happycoders.eu/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> <span class="required-field-message" aria-hidden="true">Required fields are marked <span class="required" aria-hidden="true">*</span></span></p><p class="comment-form-comment"><label for="comment">Comment <span class="required" aria-hidden="true">*</span></label> <textarea autocomplete="new-password"  id="e98bb0e3c5"  name="e98bb0e3c5"   cols="45" rows="8" maxlength="65525" required="required"></textarea><textarea id="comment" aria-hidden="true" name="comment" autocomplete="new-password" style="padding:0 !important;clip:rect(1px, 1px, 1px, 1px) !important;position:absolute !important;white-space:nowrap !important;height:1px !important;width:1px !important;overflow:hidden !important;" tabindex="-1"></textarea><script data-noptimize type="text/javascript" src="data:text/javascript;base64,ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvbW1lbnQiKS5zZXRBdHRyaWJ1dGUoImlkIiwiYTM0OTc3NThmNWIzMWEyZDNkM2FjOTc0ZjRhMGQyYmEiKTtkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZTk4YmIwZTNjNSIpLnNldEF0dHJpYnV0ZSgiaWQiLCJjb21tZW50Iik=" defer></script></p><input name="wpml_language_code" type="hidden" value="en"><p class="comment-form-author"><label for="author">Name <span class="required" aria-hidden="true">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required="required"></p>
<p class="comment-form-email"><label for="email">Email <span class="required" aria-hidden="true">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" required="required"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200"></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="22731" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p></form>	</div>
	                </div>
        
        
                <div id="_comments-40-18731" class="oxy-comments">
        
	<h3 class="comments-title"><span id="3_comments_on_Red-Black_Tree_Fully_Explained_with_Java_Code">
		3 comments on “Red-Black Tree (Fully Explained, with Java Code)”	</span></h3>

	<ol class="comments-list">

	    		<li id="comment-17046" class="comment even thread-even depth-1 parent">
			<article id="div-comment-17046" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img data-lazyloaded="1" data-placeholder-resp="40x40" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDQwIDQwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+" alt="" data-src="https://www.happycoders.eu/wp-content/litespeed/avatar/e1d9a8f37f07605b9262425ff007004f.jpg" data-srcset="https://www.happycoders.eu/wp-content/litespeed/avatar/6b8e30db072b03f0cd7f58a5ce4f22d5.jpg 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy">						<b class="fn">Sangita Elango</b> <span class="says">says:</span>					</div>

					<div class="comment-metadata">
						<a href="https://www.happycoders.eu/algorithms/red-black-tree-java/#comment-17046"><time datetime="2021-12-13T21:58:56+01:00">December 13, 2021 at 9:58 pm</time></a>					</div>

									</footer>

				<div class="comment-content">
					<p>In line 102, you have stated "Call recursively for grandparent, which is now red" and in line 104, you have called "fixRedBlackPropertiesAfterInsert(grandparent);"</p>
<p>My question is - If Uncle is black we are doing some step to get a result that changes grandparent to red too. so why you are not calling the "fixRedBlackPropertiesAfterInsert(grandparent);" in line 130 and 149. please clarify.</p>
				</div>

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://www.happycoders.eu/algorithms/red-black-tree-java/?replytocom=17046#respond" data-commentid="17046" data-postid="22731" data-belowelement="div-comment-17046" data-respondelement="respond" data-replyto="Reply to Sangita Elango" aria-label="Reply to Sangita Elango">Reply</a></div>			</article>
		<ol class="children">
		<li id="comment-17048" class="comment byuser comment-author-sven bypostauthor odd alt depth-2 parent">
			<article id="div-comment-17048" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img data-lazyloaded="1" data-placeholder-resp="40x40" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDQwIDQwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+" alt="" data-src="https://www.happycoders.eu/wp-content/litespeed/avatar/2a2f7e291c316144a9e61068434620e9.jpg" data-srcset="https://www.happycoders.eu/wp-content/litespeed/avatar/3faaf1701f65922800ff5eb02d9dd7e9.jpg 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy">						<b class="fn">Sven Woltmann</b> <span class="says">says:</span>					</div>

					<div class="comment-metadata">
						<a href="https://www.happycoders.eu/algorithms/red-black-tree-java/#comment-17048"><time datetime="2021-12-14T11:57:59+01:00">December 14, 2021 at 11:57 am</time></a>					</div>

									</footer>

				<div class="comment-content">
					<p>Thanks for this good question. You're talking about cases 4 and 5.</p>
<p>The answer is: we color	the *old* grandparent red and the *old* parent black. On rotation, the red grandparent becomes a child and the black parent becomes the new grandparent. So after the rotation, the grandparent is black. This means there can't be two subsequent red nodes, so there's no need to continue fixing by calling fixRedBlackPropertiesAfterInsert() again.</p>
<p>It is confusing that the code first rotates and then recolors. It probably would have been more understandable the other way around.</p>
				</div>

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://www.happycoders.eu/algorithms/red-black-tree-java/?replytocom=17048#respond" data-commentid="17048" data-postid="22731" data-belowelement="div-comment-17048" data-respondelement="respond" data-replyto="Reply to Sven Woltmann" aria-label="Reply to Sven Woltmann">Reply</a></div>			</article>
		<ol class="children">
		<li id="comment-17050" class="comment even depth-3">
			<article id="div-comment-17050" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img data-lazyloaded="1" data-placeholder-resp="40x40" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDQwIDQwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+" alt="" data-src="https://www.happycoders.eu/wp-content/litespeed/avatar/e1d9a8f37f07605b9262425ff007004f.jpg" data-srcset="https://www.happycoders.eu/wp-content/litespeed/avatar/6b8e30db072b03f0cd7f58a5ce4f22d5.jpg 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy">						<b class="fn">Sangita Elango</b> <span class="says">says:</span>					</div>

					<div class="comment-metadata">
						<a href="https://www.happycoders.eu/algorithms/red-black-tree-java/#comment-17050"><time datetime="2021-12-14T20:47:27+01:00">December 14, 2021 at 8:47 pm</time></a>					</div>

									</footer>

				<div class="comment-content">
					<p>Now I get it. Thankyou so much!</p>
				</div>

							</article>
		</li>
</ol>
</li>
</ol>
</li>

	</ol>

	<div class="comments-navigation">
		<div class="previous-comments-link"></div>
		<div class="next-comments-link"></div>
	</div>

	        </div>
        </div></section><section id="section-49-18731" class=" ct-section"><div class="ct-section-inner-wrap"><h4 id="headline-50-18731" class="ct-headline"><span id="You_might_also_like_the_following_articles">You might also like the following articles</span></h4><div id="code_block-57-18731" class="ct-code-block"></div>        
                <div id="_posts_grid-52-18731" class="oxy-easy-posts oxy-posts-grid">
                    <div class="oxy-posts">
                 <div class="oxy-post">
  
          <a href="https://www.happycoders.eu/algorithms/red-black-tree-java/"><img data-lazyloaded="1" data-placeholder-resp="400x225" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22400%22%20height%3D%22225%22%20viewBox%3D%220%200%20400%20225%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23643919%22%20d%3D%22M0%200h400v225H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%2300233d%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-19.83582%2082.67549%20-118.63213%20-28.46267%2056.9%20167.3)%22%2F%3E%3Cellipse%20fill%3D%22%23b36b31%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-49.5834%201.1252%20-3.4256%20-150.95254%20246.5%20129.2)%22%2F%3E%3Cellipse%20fill%3D%22%237d2c00%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-77.62169%205.15563%20-23.45433%20-353.12191%20356.6%20.8)%22%2F%3E%3Cellipse%20fill%3D%22%234f4a4f%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-97.93224%20-14.2774%204.4223%20-30.33367%20106%20125)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" data-src="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java-400x225.jpg" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java-400x225.jpg 400w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java-224x126.jpg 224w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java-336x189.jpg 336w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java-504x284.jpg 504w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java-672x378.jpg 672w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java-600x338.jpg 600w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java-800x450.jpg 800w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java-944x531.jpg 944w, https://www.happycoders.eu/wp-content/uploads/2021/09/red-black-tree-java.jpg 1200w" data-sizes="(max-width: 400px) 100vw, 400px" width="400" height="225" class="oxy-post-image" alt="Red-blak tree with Java code"></a>
	    
	<a class="oxy-post-title" href="https://www.happycoders.eu/algorithms/red-black-tree-java/">Red-Black Tree (Fully Explained, with Java Code)</a>

	<div class="oxy-post-meta">
		September 29, 2021	</div>

</div> <div class="oxy-post">
  
          <a href="https://www.happycoders.eu/algorithms/avl-tree-java/"><img data-lazyloaded="1" data-placeholder-resp="400x225" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22400%22%20height%3D%22225%22%20viewBox%3D%220%200%20400%20225%22%3E%3Cfilter%20id%3D%22b%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2212%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%236e6f68%22%20d%3D%22M0%200h400v225H0z%22%2F%3E%3Cg%20filter%3D%22url(%23b)%22%20transform%3D%22translate(.8%20.8)%20scale(1.5625)%22%20fill-opacity%3D%22.5%22%3E%3Cellipse%20fill%3D%22%23f9f8ff%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(113.5808%2011.52078%20-4.48648%2044.23119%20231.9%2029.8)%22%2F%3E%3Cellipse%20fill%3D%22%232a2d18%22%20cy%3D%22124%22%20rx%3D%22132%22%20ry%3D%22132%22%2F%3E%3Cpath%20fill%3D%22%23868689%22%20d%3D%22M125%2014l146%2068-229%205z%22%2F%3E%3Cellipse%20fill%3D%22%231c1a28%22%20cx%3D%2238%22%20cy%3D%22136%22%20rx%3D%22107%22%20ry%3D%2236%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" data-src="https://www.happycoders.eu/wp-content/uploads/2021/08/avl-tree-java-400x225.jpg" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/08/avl-tree-java-400x225.jpg 400w, https://www.happycoders.eu/wp-content/uploads/2021/08/avl-tree-java-224x126.jpg 224w, https://www.happycoders.eu/wp-content/uploads/2021/08/avl-tree-java-336x189.jpg 336w, https://www.happycoders.eu/wp-content/uploads/2021/08/avl-tree-java-504x284.jpg 504w, https://www.happycoders.eu/wp-content/uploads/2021/08/avl-tree-java-672x378.jpg 672w, https://www.happycoders.eu/wp-content/uploads/2021/08/avl-tree-java-600x338.jpg 600w, https://www.happycoders.eu/wp-content/uploads/2021/08/avl-tree-java-800x450.jpg 800w, https://www.happycoders.eu/wp-content/uploads/2021/08/avl-tree-java-944x531.jpg 944w, https://www.happycoders.eu/wp-content/uploads/2021/08/avl-tree-java.jpg 1200w" data-sizes="(max-width: 400px) 100vw, 400px" width="400" height="225" class="oxy-post-image" alt="AVL tree with Java examples"></a>
	    
	<a class="oxy-post-title" href="https://www.happycoders.eu/algorithms/avl-tree-java/">AVL Tree (with Java Code)</a>

	<div class="oxy-post-meta">
		August 31, 2021	</div>

</div> <div class="oxy-post">
  
          <a href="https://www.happycoders.eu/algorithms/binary-search-tree-java/"><img data-lazyloaded="1" data-placeholder-resp="400x225" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22400%22%20height%3D%22225%22%20viewBox%3D%220%200%20400%20225%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%23875c31%22%20d%3D%22M0%200h400v225H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23002d21%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-138.58866%20-37.16277%2015.14415%20-56.47607%2054.8%20176)%22%2F%3E%3Cellipse%20fill%3D%22%23cb8454%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-55.35698%20-263.38016%2086.0322%20-18.08216%20305.3%20157.7)%22%2F%3E%3Cellipse%20fill%3D%22%237a4c0b%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-109.2491%20-97.56%2068.36235%20-76.55316%2070.5%2038.8)%22%2F%3E%3Cellipse%20fill%3D%22%237f4215%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(54.0377%20-41.75936%2018.12299%2023.45162%20373.1%20100.3)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" data-src="https://www.happycoders.eu/wp-content/uploads/2021/06/binary-search-tree-java-400x225.jpg" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/06/binary-search-tree-java-400x225.jpg 400w, https://www.happycoders.eu/wp-content/uploads/2021/06/binary-search-tree-java-224x126.jpg 224w, https://www.happycoders.eu/wp-content/uploads/2021/06/binary-search-tree-java-336x189.jpg 336w, https://www.happycoders.eu/wp-content/uploads/2021/06/binary-search-tree-java-504x284.jpg 504w, https://www.happycoders.eu/wp-content/uploads/2021/06/binary-search-tree-java-672x378.jpg 672w, https://www.happycoders.eu/wp-content/uploads/2021/06/binary-search-tree-java-600x338.jpg 600w, https://www.happycoders.eu/wp-content/uploads/2021/06/binary-search-tree-java-800x450.jpg 800w, https://www.happycoders.eu/wp-content/uploads/2021/06/binary-search-tree-java-944x531.jpg 944w, https://www.happycoders.eu/wp-content/uploads/2021/06/binary-search-tree-java.jpg 1200w" data-sizes="(max-width: 400px) 100vw, 400px" width="400" height="225" class="oxy-post-image" alt="Binary search tree with Java examples"></a>
	    
	<a class="oxy-post-title" href="https://www.happycoders.eu/algorithms/binary-search-tree-java/">Binary Search Tree (with Java Code)</a>

	<div class="oxy-post-meta">
		June 17, 2021	</div>

</div> <div class="oxy-post">
  
          <a href="https://www.happycoders.eu/algorithms/binary-tree-java/"><img data-lazyloaded="1" data-placeholder-resp="400x225" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22400%22%20height%3D%22225%22%20viewBox%3D%220%200%20400%20225%22%3E%3Cfilter%20id%3D%22c%22%3E%3CfeGaussianBlur%20stdDeviation%3D%2255%22%20%2F%3E%3C%2Ffilter%3E%3Cpath%20fill%3D%22%235a4a32%22%20d%3D%22M0%200h400v225H0z%22%2F%3E%3Cg%20filter%3D%27url(%23c)%27%20fill-opacity%3D%27.5%27%3E%3Cellipse%20fill%3D%22%23e48547%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22rotate(177.1%20170.3%2089)%20scale(109.11817%2067.70504)%22%2F%3E%3Cpath%20fill%3D%22%23102230%22%20fill-opacity%3D%22.5%22%20d%3D%22M230.5-24.2l193.7%2053.1-448.4%20220.3z%22%2F%3E%3Cellipse%20fill%3D%22%23001%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-7.89448%2039.38635%20-147.47333%20-29.5591%2028%20193.9)%22%2F%3E%3Cellipse%20fill%3D%22%239b701b%22%20fill-opacity%3D%22.5%22%20rx%3D%221%22%20ry%3D%221%22%20transform%3D%22matrix(-85.55507%20-68.62102%2047.65548%20-59.41573%2047.7%2030.6)%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" data-src="https://www.happycoders.eu/wp-content/uploads/2021/05/binary-tree-java-400x225.jpg" data-srcset="https://www.happycoders.eu/wp-content/uploads/2021/05/binary-tree-java-400x225.jpg 400w, https://www.happycoders.eu/wp-content/uploads/2021/05/binary-tree-java-224x126.jpg 224w, https://www.happycoders.eu/wp-content/uploads/2021/05/binary-tree-java-336x189.jpg 336w, https://www.happycoders.eu/wp-content/uploads/2021/05/binary-tree-java-504x284.jpg 504w, https://www.happycoders.eu/wp-content/uploads/2021/05/binary-tree-java-672x378.jpg 672w, https://www.happycoders.eu/wp-content/uploads/2021/05/binary-tree-java-600x338.jpg 600w, https://www.happycoders.eu/wp-content/uploads/2021/05/binary-tree-java-800x450.jpg 800w, https://www.happycoders.eu/wp-content/uploads/2021/05/binary-tree-java-944x531.jpg 944w, https://www.happycoders.eu/wp-content/uploads/2021/05/binary-tree-java.jpg 1200w" data-sizes="(max-width: 400px) 100vw, 400px" width="400" height="225" class="oxy-post-image" alt="Binary Tree With Java Examples"></a>
	    
	<a class="oxy-post-title" href="https://www.happycoders.eu/algorithms/binary-tree-java/">Binary Tree (with Java Code)</a>

	<div class="oxy-post-meta">
		May 28, 2021	</div>

</div>            </div>
                        <div class="oxy-easy-posts-pages">
                            </div>
                            </div>
                <div id="code_block-60-18731" class="ct-code-block"></div></div></section><section id="section-1-18185" class=" ct-section hc_footer"><div class="ct-section-inner-wrap"><div id="div_block-8-18185" class="ct-div-block"><div id="new_columns-2-18185" class="ct-new-columns"><div id="div_block-3-18185" class="ct-div-block"><a id="link-66-18185" class="ct-link" href="/"><img id="image-6-18185" alt="HappyCoders logo" src="https://www.happycoders.eu/wp-content/uploads/2018/07/happycoders_white.svg" class="ct-image" srcset="" sizes="(max-width: 296px) 100vw, 296px"></a><div id="text_block-36-18185" class="ct-text-block">Advanced Java topics, algorithms and data structures.</div><div id="text_block-109-18185" class="ct-text-block">Join Our Free Newsletter</div><div id="text_block-111-18185" class="ct-text-block">Boost your skills: Become a better Java programmer.</div><a id="link_button-115-18185" class="ct-link-button" href="#" data-formkit-toggle="c5fd58ecdd">CLICK HERE TO SUBSCRIBE!</a><div id="shortcode-122-18185" class="ct-shortcode"><script data-uid="c5fd58ecdd" src="https://happycoders.ck.page/c5fd58ecdd/index.js" defer data-deferred="1"></script></div></div><div id="div_block-4-18185" class="ct-div-block"><div id="new_columns-27-18185" class="ct-new-columns"><div id="div_block-29-18185" class="ct-div-block"><div id="text_block-31-18185" class="ct-text-block">Blog<br></div><a id="text_block-41-18185" class="ct-link-text" href="/java/">Java<br></a><a id="text_block-51-18185" class="ct-link-text" href="/algorithms/">Algorithms and Data Structures<br></a><a id="text_block-55-18185" class="ct-link-text" href="/devops/">DevOps<br></a><a id="text_block-56-18185" class="ct-link-text" href="/books/">Book Recommendations</a></div><div id="div_block-30-18185" class="ct-div-block"><div id="text_block-34-18185" class="ct-text-block">Resources<br></div><a id="link_text-68-18185" class="ct-link-text" href="/big-o-cheat-sheet/"><div>Big O Cheat Sheet</div></a><a id="link_text-105-18185" class="ct-link-text" href="/newsletter/"><div>Newsletter</div></a><a id="link_text-67-18185" class="ct-link-text" href="/courses/"><div>Java Training</div></a></div></div><div id="new_columns-80-18185" class="ct-new-columns"><div id="div_block-81-18185" class="ct-div-block"><div id="text_block-82-18185" class="ct-text-block">About<br></div><a id="text_block-60-18185" class="ct-link-text" href="/about-sven-woltmann/">About Sven Woltmann<br></a><a id="text_block-61-18185" class="ct-link-text" href="/manifesto/">HappyCoders Manifesto<br></a></div><div id="div_block-87-18185" class="ct-div-block"><div id="text_block-20-18185" class="ct-text-block">Follow us</div><div id="code_block-65-18185" class="ct-code-block hc_follow"><a href="https://twitter.com/svenwoltmann" target="_blank" rel="noopener" title="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewbox="-6 -6 36 36" style="width:36px"><circle cx="12" cy="12" r="18" fill="#999999"></circle><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z" fill="white"></path></svg></a><a href="https://www.linkedin.com/in/sven-woltmann/" target="_blank" rel="noopener" title="LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" viewbox="-8 -6 40 40" style="width:36px"><circle cx="12" cy="14" r="20" fill="#999999"></circle><path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z" fill="white"></path></svg></a><a href="https://www.xing.com/profile/Sven_Woltmann" target="_blank" rel="noopener" title="Xing"><svg xmlns="http://www.w3.org/2000/svg" viewbox="-6 -6 36 36" style="width:36px"><circle cx="12" cy="12" r="18" fill="#999999"></circle><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z" fill="white"></path></svg></a><a href="https://www.youtube.com/c/happycoders" target="_blank" rel="noopener" title="YouTube"><svg xmlns="http://www.w3.org/2000/svg" viewbox="-4 -4 32 32" style="width:36px"><circle cx="12" cy="12" r="16" fill="#999999"></circle><path d="M23.495 6.205a3.007 3.007 0 0 0-2.088-2.088c-1.87-.501-9.396-.501-9.396-.501s-7.507-.01-9.396.501A3.007 3.007 0 0 0 .527 6.205a31.247 31.247 0 0 0-.522 5.805 31.247 31.247 0 0 0 .522 5.783 3.007 3.007 0 0 0 2.088 2.088c1.868.502 9.396.502 9.396.502s7.506 0 9.396-.502a3.007 3.007 0 0 0 2.088-2.088 31.247 31.247 0 0 0 .5-5.783 31.247 31.247 0 0 0-.5-5.805zM9.609 15.601V8.408l6.264 3.602z" fill="white"></path></svg></a></div></div></div></div></div></div><div id="new_columns-9-18185" class="ct-new-columns"><div id="div_block-10-18185" class="ct-div-block"><div id="text_block-7-18185" class="ct-text-block">Copyright © 2018–2021 Sven Woltmann</div></div><div id="div_block-11-18185" class="ct-div-block"><a id="text_block-13-18185" class="ct-link-text" href="/legal-notice/">Legal Notice</a><a id="link_text-18-18185" class="ct-link-text" href="/privacy-policy/">Privacy Policy</a></div></div></div></section>	
<script type="text/javascript" id="ct_custom_js_9" src="data:text/javascript;base64,alF1ZXJ5KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigkKXskKCcuaGNfc2VhcmNoX2ljb24nKS5jbGljayhmdW5jdGlvbigpe2lmKCQoJyNoYy1zZWFyY2gtb3ZlcmxheScpLmxlbmd0aD09PTApeyQoImJvZHkiKS5hcHBlbmQoJzxkaXYgaWQ9ImhjLXNlYXJjaC1vdmVybGF5IiBjbGFzcz0iaGMtc2VhcmNoLW92ZXJsYXkiPjxkaXYgY2xhc3M9ImhjLXNlYXJjaC1zZWN0aW9uIj48ZGl2IGNsYXNzPSJoYy1zZWFyY2gtZm9ybSI+PGZvcm0gcm9sZT0ic2VhcmNoIiBtZXRob2Q9ImdldCIgaWQ9InNlYXJjaGZvcm0iIGNsYXNzPSJzZWFyY2hmb3JtIiBhY3Rpb249Imh0dHBzOi8vd3d3LmhhcHB5Y29kZXJzLmV1LyI+PGRpdj48aW5wdXQgdHlwZT0idGV4dCIgdmFsdWU9IiIgcGxhY2Vob2xkZXI9IlNlYXJjaCIgbmFtZT0icyIgaWQ9InMiPjxpbnB1dCB0eXBlPSJzdWJtaXQiIGlkPSJzZWFyY2hzdWJtaXQiIHZhbHVlPSJTZWFyY2giPjwvZGl2PjwvZm9ybT48L2Rpdj48L2Rpdj48L2Rpdj4nKX0KJCgnI2hjLXNlYXJjaC1vdmVybGF5Jykuc2xpZGVUb2dnbGUoKX0pOyQoZG9jdW1lbnQpLmtleXVwKGZ1bmN0aW9uKGUpe2lmKGUua2V5PT0nRXNjYXBlJyl7JCgnI2hjLXNlYXJjaC1vdmVybGF5JykuaGlkZSgpfX0pfSk=" defer></script>
<style>.ct-FontAwesomeicon-search{width:0.92857142857143em}</style>
<?xml version="1.0"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="position: absolute; width: 0; height: 0; overflow: hidden;" version="1.1"><defs><symbol id="FontAwesomeicon-search" viewBox="0 0 26 28"><title>search</title><path d="M18 13c0-3.859-3.141-7-7-7s-7 3.141-7 7 3.141 7 7 7 7-3.141 7-7zM26 26c0 1.094-0.906 2-2 2-0.531 0-1.047-0.219-1.406-0.594l-5.359-5.344c-1.828 1.266-4.016 1.937-6.234 1.937-6.078 0-11-4.922-11-11s4.922-11 11-11 11 4.922 11 11c0 2.219-0.672 4.406-1.937 6.234l5.359 5.359c0.359 0.359 0.578 0.875 0.578 1.406z"/></symbol></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-dark-grayscale"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0 0.49803921568627" /><feFuncG type="table" tableValues="0 0.49803921568627" /><feFuncB type="table" tableValues="0 0.49803921568627" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-grayscale"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0 1" /><feFuncG type="table" tableValues="0 1" /><feFuncB type="table" tableValues="0 1" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-purple-yellow"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0.54901960784314 0.98823529411765" /><feFuncG type="table" tableValues="0 1" /><feFuncB type="table" tableValues="0.71764705882353 0.25490196078431" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-blue-red"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0 1" /><feFuncG type="table" tableValues="0 0.27843137254902" /><feFuncB type="table" tableValues="0.5921568627451 0.27843137254902" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-midnight"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0 0" /><feFuncG type="table" tableValues="0 0.64705882352941" /><feFuncB type="table" tableValues="0 1" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-magenta-yellow"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0.78039215686275 1" /><feFuncG type="table" tableValues="0 0.94901960784314" /><feFuncB type="table" tableValues="0.35294117647059 0.47058823529412" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-purple-green"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0.65098039215686 0.40392156862745" /><feFuncG type="table" tableValues="0 1" /><feFuncB type="table" tableValues="0.44705882352941 0.4" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-blue-orange"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0.098039215686275 1" /><feFuncG type="table" tableValues="0 0.66274509803922" /><feFuncB type="table" tableValues="0.84705882352941 0.41960784313725" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg>
		<script type="text/javascript" src="data:text/javascript;base64,alF1ZXJ5KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpe2pRdWVyeSgnYm9keScpLm9uKCdjbGljaycsJy5veHktbWVudS10b2dnbGUnLGZ1bmN0aW9uKCl7alF1ZXJ5KHRoaXMpLnBhcmVudCgnLm94eS1uYXYtbWVudScpLnRvZ2dsZUNsYXNzKCdveHktbmF2LW1lbnUtb3BlbicpO2pRdWVyeSgnYm9keScpLnRvZ2dsZUNsYXNzKCdveHktbmF2LW1lbnUtcHJldmVudC1vdmVyZmxvdycpO2pRdWVyeSgnaHRtbCcpLnRvZ2dsZUNsYXNzKCdveHktbmF2LW1lbnUtcHJldmVudC1vdmVyZmxvdycpfSk7dmFyIHNlbGVjdG9yPScub3h5LW5hdi1tZW51LW9wZW4gLm1lbnUtaXRlbSBhW2hyZWYqPSIjIl0nO2pRdWVyeSgnYm9keScpLm9uKCdjbGljaycsc2VsZWN0b3IsZnVuY3Rpb24oKXtqUXVlcnkoJy5veHktbmF2LW1lbnUtb3BlbicpLnJlbW92ZUNsYXNzKCdveHktbmF2LW1lbnUtb3BlbicpO2pRdWVyeSgnYm9keScpLnJlbW92ZUNsYXNzKCdveHktbmF2LW1lbnUtcHJldmVudC1vdmVyZmxvdycpO2pRdWVyeSgnaHRtbCcpLnJlbW92ZUNsYXNzKCdveHktbmF2LW1lbnUtcHJldmVudC1vdmVyZmxvdycpO2pRdWVyeSh0aGlzKS5jbGljaygpfSl9KQ==" defer></script>

	<style>.wp-container-62045446dd6a1 .alignleft { float: left; margin-right: 2em; }.wp-container-62045446dd6a1 .alignright { float: right; margin-left: 2em; }</style>
<script type='text/javascript' id='convertkit-js-js-extra' src="data:text/javascript;base64,dmFyIGNvbnZlcnRraXQ9eyJhamF4dXJsIjoiaHR0cHM6XC9cL3d3dy5oYXBweWNvZGVycy5ldVwvd3AtYWRtaW5cL2FkbWluLWFqYXgucGhwIiwiZGVidWciOiIiLCJub25jZSI6ImVmNWQzZDUwN2IiLCJzdWJzY3JpYmVyX2lkIjoiMCIsInRhZyI6IiIsInBvc3RfaWQiOiIyMjczMSJ9" defer></script>
<script   type='text/javascript' src='https://www.happycoders.eu/wp-content/plugins/convertkit/resources/frontend/js/convertkit.js?ver=1.9.6.6' id='convertkit-js-js' defer data-deferred="1"></script>
<script   type='text/javascript' src='https://www.happycoders.eu/wp-content/plugins/luckywp-table-of-contents/front/assets/main.min.js?ver=2.1.4' id='lwptoc-main-js' defer data-deferred="1"></script>
<style>.lwptoc .lwptoc_i{border:1px solid #aaaaaa;}.lwptoc .lwptoc_i A{color:#1080b6;}.lwptoc .lwptoc_i A:hover,.lwptoc .lwptoc_i A:focus,.lwptoc .lwptoc_i A:active{color:#58a6cc;border-color:#58a6cc;}.lwptoc .lwptoc_i A:visited{color:#1080b6;}</style><script type="text/javascript" id="ct_code_block_js_1" src="data:text/javascript;base64,ZnVuY3Rpb24gb3BlblNoYXJlcih1LHcsaCl7dmFyIHNsPXZvaWQgMCE9PXdpbmRvdy5zY3JlZW5MZWZ0P3dpbmRvdy5zY3JlZW5MZWZ0OnNjcmVlbi5sZWZ0LHN0PXZvaWQgMCE9PXdpbmRvdy5zY3JlZW5Ub3A/d2luZG93LnNjcmVlblRvcDpzY3JlZW4udG9wLGw9KHdpbmRvdy5pbm5lcldpZHRoP3dpbmRvdy5pbm5lcldpZHRoOmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aD9kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGg6c2NyZWVuLndpZHRoKS8yLXcvMitzbCx0PSh3aW5kb3cuaW5uZXJIZWlnaHQ/d2luZG93LmlubmVySGVpZ2h0OmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQ/ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodDpzY3JlZW4uaGVpZ2h0KS8yLWgvMitzdCx3bmQ9d2luZG93Lm9wZW4odSwic2hhcmVyIiwic2Nyb2xsYmFycz15ZXMscmVzaXphYmxlPXllcyx0b29sYmFyPW5vLG1lbnViYXI9bm8sc2Nyb2xsYmFycz1ubyxsb2NhdGlvbj1ubyxkaXJlY3Rvcmllcz1ubyx3aWR0aD0iK3crIiwgaGVpZ2h0PSIraCsiLCB0b3A9Iit0KyIsIGxlZnQ9IitsKTtpZih3aW5kb3cuZm9jdXMpe3duZC5mb2N1cygpfX0KZnVuY3Rpb24gb3BlblNoYXJlckZCKCl7b3BlblNoYXJlcignaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL3NoYXJlci9zaGFyZXIucGhwP3U9JytlbmNvZGVVUklDb21wb25lbnQoZG9jdW1lbnQuVVJMKSw2NTAsNTAwKX0KZnVuY3Rpb24gb3BlblNoYXJlclRXKCl7b3BlblNoYXJlcignaHR0cHM6Ly90d2l0dGVyLmNvbS9pbnRlbnQvdHdlZXQ/dXJsPScrZW5jb2RlVVJJQ29tcG9uZW50KGRvY3VtZW50LlVSTCksNTUwLDQ1MCl9CmZ1bmN0aW9uIG9wZW5TaGFyZXJMSSgpe29wZW5TaGFyZXIoJ2h0dHBzOi8vd3d3LmxpbmtlZGluLmNvbS9zaGFyZUFydGljbGU/bWluaT10cnVlJnVybD0nK2VuY29kZVVSSUNvbXBvbmVudChkb2N1bWVudC5VUkwpLDU1MCw0MDApfQpmdW5jdGlvbiBvcGVuU2hhcmVyWEkoKXtvcGVuU2hhcmVyKCdodHRwczovL3d3dy54aW5nLmNvbS9zcGkvc2hhcmVzL25ldz91cmw9JytlbmNvZGVVUklDb21wb25lbnQoZG9jdW1lbnQuVVJMKSw2MDAsNTAwKX0=" defer></script>
<noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:600,italic,regular|Roboto+Slab:700,regular&amp;display=swap" media="all" /></noscript>
 
<script data-no-optimize="1" defer>var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.LazyLoad=e()}(this,function(){"use strict";function r(t,e){return t.getAttribute(o+e)}function s(t,e,n){e=o+e,null!==n?t.setAttribute(e,n):t.removeAttribute(e)}function i(t){return r(t,u)===f}function l(t,e){return s(t,d,e),0}function c(t){return r(t,d)}function a(t,e){var n,o="LazyLoad::Initialized",s=new t(e);try{n=new CustomEvent(o,{detail:{instance:s}})}catch(t){(n=document.createEvent("CustomEvent")).initCustomEvent(o,!1,!1,{instance:s})}window.dispatchEvent(n)}var n={elements_selector:"img",container:document,threshold:300,thresholds:null,data_src:"src",data_srcset:"srcset",data_sizes:"sizes",data_bg:"bg",class_loading:"litespeed-loading",class_loaded:"litespeed-loaded",class_error:"error",load_delay:0,callback_load:null,callback_error:null,callback_set:null,callback_enter:null,callback_finish:null,to_webp:!1},o="data-",u="was-processed",d="ll-timeout",f="true";function _(t,e){return e?t.replace(/\.(jpe?g|png)/gi,".webp"):t}function h(t,e,n,o){for(var s,i,a=0;s=t.children[a];a+=1)"SOURCE"===s.tagName&&(i=r(s,n),A(s,e,i,o))}function b(t,e){var n,o,s=e._settings,i=t.tagName;if(i=C[i])return i(t,s),e._updateLoadingCount(1),e._elements=(o=e._elements,n=t,o.filter(function(t){return t!==n})),0;e=t,o=s,t=z&&o.to_webp,s=r(e,o.data_src),o=r(e,o.data_bg),s&&(s=_(s,t),e.style.backgroundImage='url("'+s+'")'),o&&(t=_(o,t),e.style.backgroundImage=t)}function g(t,e){k?t.classList.add(e):t.className+=(t.className?" ":"")+e}function m(t,e){t&&t(e)}function v(t,e,n){t.addEventListener(e,n)}function p(t,e,n){t.removeEventListener(e,n)}function y(t,e,n){p(t,N,e),p(t,S,e),p(t,x,n)}function w(t,e,n){var o=n._settings,s=e?o.class_loaded:o.class_error,i=e?o.callback_load:o.callback_error,e=t.target;t=e,o=o.class_loading,k?t.classList.remove(o):t.className=t.className.replace(new RegExp("(^|\\s+)"+o+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,""),g(e,s),m(i,e),n._updateLoadingCount(-1)}function E(n,o){function s(t){w(t,!0,o),y(n,s,a)}var t,e,i,a=function t(e){w(e,!1,o),y(n,s,t)};i=a,v(t=n,N,e=s),v(t,S,e),v(t,x,i)}function L(t,e,n){R(t,n),e.unobserve(t)}function I(t){var e=c(t);e&&(clearTimeout(e),l(t,null))}var t="undefined"!=typeof window,O=t&&!("onscroll"in window)||/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),e=t&&"IntersectionObserver"in window,k=t&&"classList"in document.createElement("p"),z=t&&!1,A=function(t,e,n,o){n&&t.setAttribute(e,_(n,o))},C={IMG:function(t,e){var n=z&&e.to_webp,o=e.data_srcset,s=t.parentNode;s&&"PICTURE"===s.tagName&&h(s,"srcset",o,n);s=r(t,e.data_sizes);A(t,"sizes",s);o=r(t,o);A(t,"srcset",o,n);e=r(t,e.data_src);A(t,"src",e,n)},IFRAME:function(t,e){e=r(t,e.data_src);A(t,"src",e)},VIDEO:function(t,e){var n=e.data_src,e=r(t,n);h(t,"src",n),A(t,"src",e),t.load()}},N="load",S="loadeddata",x="error",M=["IMG","IFRAME","VIDEO"];function R(t,e,n){var o=e._settings;!n&&i(t)||(m(o.callback_enter,t),-1<M.indexOf(t.tagName)&&(E(t,e),g(t,o.class_loading)),b(t,e),s(t,u,f),m(o.callback_set,t))}function j(t){return t.isIntersecting||0<t.intersectionRatio}function T(t,e){this._settings=_extends({},n,t),this._setObserver(),this._loadingCount=0,this.update(e)}return T.prototype={_manageIntersection:function(t){var e,n,o,s,i=this._observer,a=this._settings.load_delay,r=t.target;a?j(t)?(e=r,n=i,s=(o=this)._settings.load_delay,(a=c(e))||(a=setTimeout(function(){L(e,n,o),I(e)},s),l(e,a))):I(r):j(t)&&L(r,i,this)},_onIntersection:function(t){t.forEach(this._manageIntersection.bind(this))},_setObserver:function(){var t;e&&(this._observer=new IntersectionObserver(this._onIntersection.bind(this),{root:(t=this._settings).container===document?null:t.container,rootMargin:t.thresholds||t.threshold+"px"}))},_updateLoadingCount:function(t){this._loadingCount+=t,0===this._elements.length&&0===this._loadingCount&&m(this._settings.callback_finish)},update:function(t){var e=this,n=this._settings,n=t||n.container.querySelectorAll(n.elements_selector);this._elements=Array.prototype.slice.call(n).filter(function(t){return!i(t)}),!O&&this._observer?this._elements.forEach(function(t){e._observer.observe(t)}):this.loadAll()},destroy:function(){var e=this;this._observer&&(this._elements.forEach(function(t){e._observer.unobserve(t)}),this._observer=null),this._elements=null,this._settings=null},load:function(t,e){R(t,this,e)},loadAll:function(){var e=this;this._elements.forEach(function(t){e.load(t)})}},t&&function(t,e){if(e)if(e.length)for(var n,o=0;n=e[o];o+=1)a(t,n);else a(t,e)}(T,window.lazyLoadOptions),T}),function(t,e){"use strict";function n(){e.body.classList.add("litespeed_lazyloaded")}function o(){console.log("[LiteSpeed] Start Lazyload image"),s=new LazyLoad({elements_selector:"[data-lazyloaded]",callback_finish:n}),i=function(){s.update()},t.MutationObserver&&new MutationObserver(i).observe(e.documentElement,{childList:!0,subtree:!0,attributes:!0})}var s,i;t.addEventListener?t.addEventListener("load",o,!1):t.attachEvent("onload",o)}(window,document);</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/v652eace1692a40cfa3763df669d7439c1639079717194" integrity="sha512-Gi7xpJR8tSkrpF7aordPZQlW2DLtzUlZcumS8dMQjwDHEnw9I7ZLyiOj/6tZStRBGtGgN6ceN6cMH8z7etPGlw==" data-cf-beacon='{"rayId":"6dd511733e0e41d6","token":"0e2bc9ea4a9947d9b9cbe3dc6ef57666","version":"2021.12.0","si":100}' crossorigin="anonymous"></script>
</body>
</html>